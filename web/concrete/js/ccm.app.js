function ccm_previewInternalTheme(a,b,c){var d=$("input[name=ptID]").val();$.fn.dialog.open({title:c,href:CCM_TOOLS_PATH+"/themes/preview?themeID="+b+"&previewCID="+a+"&ptID="+d,width:"85%",modal:!1,height:"75%"})}function ccm_previewMarketplaceTheme(a,b,c,d){var e=$("input[name=ptID]").val();$.fn.dialog.open({title:c,href:CCM_TOOLS_PATH+"/themes/preview?themeCID="+b+"&previewCID="+a+"&themeHandle="+encodeURIComponent(d)+"&ptID="+e,width:"85%",modal:!1,height:"75%"})}"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var c5=function(a){"use strict";function b(a,b){return a[b]}function c(a,b,c){return a[b]=c,c}var d={editMode:null,event:a,createGetterSetters:function(a){var d=this;return d.getAttr=_.partial(b,a),d.setAttr=_.partial(c,a),_(a).each(function(e,f){f+="";var g="get"+f.substr(0,1).toUpperCase()+f.substr(1),h="set"+f.substr(0,1).toUpperCase()+f.substr(1);"undefined"==typeof d[g]&&(d[g]=_.partial(b,a,f)),"undefined"==typeof d[h]&&(d[h]=_.partial(c,a,f))}),!0}};return d}(ccm_event);!function(a){a.fn.hoverIntent=function(b,c){var d={sensitivity:7,interval:100,timeout:0};d=a.extend(d,c?{over:b,out:c}:b);var e,f,g,h,i=function(a){e=a.pageX,f=a.pageY},j=function(b,c){return c.hoverIntent_t=clearTimeout(c.hoverIntent_t),Math.abs(g-e)+Math.abs(h-f)<d.sensitivity?(a(c).unbind("mousemove",i),c.hoverIntent_s=1,d.over.apply(c,[b])):(g=e,h=f,c.hoverIntent_t=setTimeout(function(){j(b,c)},d.interval),void 0)},k=function(a,b){return b.hoverIntent_t=clearTimeout(b.hoverIntent_t),b.hoverIntent_s=0,d.out.apply(b,[a])},l=function(b){var c=jQuery.extend({},b),e=this;e.hoverIntent_t&&(e.hoverIntent_t=clearTimeout(e.hoverIntent_t)),"mouseenter"==b.type?(g=c.pageX,h=c.pageY,a(e).bind("mousemove",i),1!=e.hoverIntent_s&&(e.hoverIntent_t=setTimeout(function(){j(c,e)},d.interval))):(a(e).unbind("mousemove",i),1==e.hoverIntent_s&&(e.hoverIntent_t=setTimeout(function(){k(c,e)},d.timeout)))};return this.bind("mouseenter",l).bind("mouseleave",l)}}(jQuery),function(a){var b=null;a.fn.liveUpdate=function(b,c){return this.each(function(){new a.liveUpdate(this,b,c)})},a.liveUpdate=function(b,c,d){this.field=a(b),a(b).data("liveUpdate",this),this.list=a("#"+c),this.lutype="blocktypes","undefined"!=typeof d&&(this.lutype=d),this.list.length>0&&this.init()},a.liveUpdate.prototype={init:function(){var a=this;this.setupCache(),this.field.parents("form").submit(function(){return!1}),this.field.keyup(function(){a.filter()}),a.filter()},filter:function(){if(this.field.val()!=b){if(""==a.trim(this.field.val()))return"blocktypes"==this.lutype||("attributes"==this.lutype?(this.list.find("h5").show(),this.list.find("li").show()):"stacks"==this.lutype?(this.list.children("li").addClass("ccm-stack-available"),this.list.children("li").removeClass("ccm-stack-selected")):"intelligent-search"==this.lutype?this.list.is(":visible")&&this.list.hide():this.list.children("li").show()),void 0;"intelligent-search"!=this.lutype||this.field.val().length>2?this.displayResults(this.getScores(this.field.val().toLowerCase())):"intelligent-search"==this.lutype&&this.list.is(":visible")&&this.list.hide()}b=this.field.val(),""==b&&"intelligent-search"==this.lutype&&this.list.is(":visible")&&this.list.hide()},setupCache:function(){var b=this;this.cache=[],this.rows=[];var c=this.lutype;this.list.find("li").each(function(){if("blocktypes"==c)b.cache.push(a(this).find("span").html().toLowerCase());else if("attributes"==c){var d=a(this).find("a,span").html().toLowerCase();b.cache.push(d)}else if("stacks"==c){var d=a(this).find("a,span").html().toLowerCase();b.cache.push(d)}else if("fileset"==c)b.cache.push(a(this).find("span").html().toLowerCase());else if("intelligent-search"==c){var e=a(this).find("span").html();e&&b.cache.push(e.toLowerCase())}b.rows.push(a(this))}),this.cache_length=this.cache.length},displayResults:function(b){var c=this;if("blocktypes"==this.lutype)this.list.children("li").hide(),a.each(b,function(a,b){c.rows[b[1]].show()});else if("attributes"==this.lutype)this.list.find("h5").hide(),this.list.find("li").hide(),a.each(b,function(a,b){c.rows[b[1]].show()});else if("stacks"==this.lutype)this.list.children("li").removeClass("ccm-stack-available"),this.list.children("li").removeClass("ccm-stack-selected"),this.list.children("li").removeClass("ccm-item-selected"),a.each(b,function(a,b){c.rows[b[1]].addClass("ccm-stack-available")}),this.list.children("li.item-select-list-header").removeClass("ccm-stack-available"),a(this.list.find("li.ccm-stack-available")[0]).addClass("ccm-item-selected");else if("intelligent-search"==this.lutype){this.list.is(":visible")||this.list.fadeIn(160,"easeOutExpo"),this.list.find(".ccm-intelligent-search-results-module-onsite").hide(),this.list.find("li").hide();var d=0;a.each(b,function(a,b){$li=c.rows[b[1]],b[0]>.75&&(d++,$li.parent().parent().is(":visible")||$li.parent().parent().show(),$li.show())}),this.list.find("li a").removeClass("ccm-intelligent-search-result-selected"),this.list.find("li:visible a:first").addClass("ccm-intelligent-search-result-selected")}else this.list.children("li").hide(),a.each(b,function(a,b){c.rows[b[1]].show()})},getScores:function(a){for(var b=[],c=0;c<this.cache_length;c++){var d=this.cache[c].score(a);d>0&&b.push([d,c])}return b.sort(function(a,b){return b[0]-a[0]})}}}(jQuery),function(){var a,b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};d=this,a=jQuery,a.fn.extend({chosen:function(c){return"msie"!==a.browser||"6.0"!==a.browser.version&&"7.0"!==a.browser.version?a(this).each(function(){return a(this).hasClass("chzn-done")?void 0:new b(this,c)}):this}}),b=function(){function b(b,c){this.form_field=b,this.options=null!=c?c:{},this.set_default_values(),this.form_field_jq=a(this.form_field),this.is_multiple=this.form_field.multiple,this.is_rtl=this.form_field_jq.hasClass("chzn-rtl"),this.default_text_default=this.form_field.multiple?"Select Some Options":"Select an Option",this.set_up_html(),this.register_observers(),this.form_field_jq.addClass("chzn-done")}return b.prototype.set_default_values=function(){return this.click_test_action=e(function(a){return this.test_active_click(a)},this),this.activate_action=e(function(a){return this.activate_field(a)},this),this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.choices=0,this.results_none_found=this.options.no_results_text||"No results match"},b.prototype.set_up_html=function(){var b,d,e,f;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/(:|\.)/g,"_"):this.generate_field_id(),this.container_id+="_chzn",this.f_width=this.form_field_jq.outerWidth(),this.default_text=this.form_field_jq.data("placeholder")?this.form_field_jq.data("placeholder"):this.default_text_default,b=a("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"}),this.is_multiple?b.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):b.html('<a href="javascript:void(0)" class="chzn-single"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(b),this.container=a("#"+this.container_id),this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single")),!this.is_multiple&&this.form_field.options.length<=this.disable_search_threshold&&this.container.addClass("chzn-container-single-nosearch"),this.dropdown=this.container.find("div.chzn-drop").first(),d=this.container.height(),e=this.f_width-c(this.dropdown),this.dropdown.css({width:e+"px",top:d+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),f=e-c(this.search_container)-c(this.search_field),this.search_field.css({width:f+"px"})),this.results_build(),this.set_tab_index()},b.prototype.register_observers=function(){return this.container.mousedown(e(function(a){return this.container_mousedown(a)},this)),this.container.mouseup(e(function(a){return this.container_mouseup(a)},this)),this.container.mouseenter(e(function(a){return this.mouse_enter(a)},this)),this.container.mouseleave(e(function(a){return this.mouse_leave(a)},this)),this.search_results.mouseup(e(function(a){return this.search_results_mouseup(a)},this)),this.search_results.mouseover(e(function(a){return this.search_results_mouseover(a)},this)),this.search_results.mouseout(e(function(a){return this.search_results_mouseout(a)},this)),this.form_field_jq.bind("liszt:updated",e(function(a){return this.results_update_field(a)},this)),this.search_field.blur(e(function(a){return this.input_blur(a)},this)),this.search_field.keyup(e(function(a){return this.keyup_checker(a)},this)),this.search_field.keydown(e(function(a){return this.keydown_checker(a)},this)),this.is_multiple?(this.search_choices.click(e(function(a){return this.choices_click(a)},this)),this.search_field.focus(e(function(a){return this.input_focus(a)},this))):void 0},b.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq.attr("disabled"),this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field.attr("disabled",!0),this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field.attr("disabled",!1),this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},b.prototype.container_mousedown=function(b){var c;return this.is_disabled?void 0:(c=null!=b?a(b.target).hasClass("search-choice-close"):!1,b&&"mousedown"===b.type&&b.stopPropagation(),this.pending_destroy_click||c?this.pending_destroy_click=!1:(this.active_field?this.is_multiple||!b||a(b.target)!==this.selected_item&&!a(b.target).parents("a.chzn-single").length||(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).click(this.click_test_action),this.results_show()),this.activate_field()))},b.prototype.container_mouseup=function(a){return"ABBR"===a.target.nodeName?this.results_reset(a):void 0},b.prototype.mouse_enter=function(){return this.mouse_on_container=!0},b.prototype.mouse_leave=function(){return this.mouse_on_container=!1},b.prototype.input_focus=function(){return this.active_field?void 0:setTimeout(e(function(){return this.container_mousedown()},this),50)},b.prototype.input_blur=function(){return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(e(function(){return this.blur_test()},this),100))},b.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},b.prototype.close_field=function(){return a(document).unbind("click",this.click_test_action),this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1)),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},b.prototype.activate_field=function(){return this.is_multiple||this.active_field||(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1)),this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},b.prototype.test_active_click=function(b){return a(b.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},b.prototype.results_build=function(){var a,b,c,e,f,g;for(c=new Date,this.parsing=!0,this.results_data=d.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||this.selected_item.find("span").text(this.default_text),a="",g=this.results_data,e=0,f=g.length;f>e;e++)b=g[e],b.group?a+=this.result_add_group(b):b.empty||(a+=this.result_add_option(b),b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&(this.selected_item.find("span").text(b.text),this.allow_single_deselect&&this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(a),this.parsing=!1},b.prototype.result_add_group=function(b){return b.disabled?"":(b.dom_id=this.container_id+"_g_"+b.array_index,'<li id="'+b.dom_id+'" class="group-result">'+a("<div />").text(b.label).html()+"</li>")},b.prototype.result_add_option=function(a){var b,c;return a.disabled?"":(a.dom_id=this.container_id+"_o_"+a.array_index,b=a.selected&&this.is_multiple?[]:["active-result"],a.selected&&b.push("result-selected"),null!=a.group_array_index&&b.push("group-option"),""!==a.classes&&b.push(a.classes),c=""!==a.style.cssText?' style="'+a.style+'"':"",'<li id="'+a.dom_id+'" class="'+b.join(" ")+'"'+c+">"+a.html+"</li>")},b.prototype.results_update_field=function(){return this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},b.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){if(this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight(),b>=e)return this.search_results.scrollTop(b-d>0?b-d:0);if(f>c)return this.search_results.scrollTop(c)}},b.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},b.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},b.prototype.results_show=function(){var a;return this.is_multiple||(this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected)),a=this.is_multiple?this.container.height():this.container.height()-1,this.dropdown.css({top:a+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},b.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},b.prototype.set_tab_index=function(){var a;return this.form_field_jq.attr("tabindex")?(a=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.is_multiple?this.search_field.attr("tabindex",a):(this.selected_item.attr("tabindex",a),this.search_field.attr("tabindex",-1))):void 0},b.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},b.prototype.search_results_mouseup=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c.length?(this.result_highlight=c,this.result_select(b)):void 0},b.prototype.search_results_mouseover=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c?this.result_do_highlight(c):void 0},b.prototype.search_results_mouseout=function(b){return a(b.target).hasClass("active-result")?this.result_clear_highlight():void 0},b.prototype.choices_click=function(b){return b.preventDefault(),!this.active_field||a(b.target).hasClass("search-choice")||this.results_showing?void 0:this.results_show()},b.prototype.choice_build=function(b){var c,d;return c=this.container_id+"_c_"+b.array_index,this.choices+=1,this.search_container.before('<li class="search-choice" id="'+c+'"><span>'+b.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+b.array_index+'"></a></li>'),d=a("#"+c).find("a").first(),d.click(e(function(a){return this.choice_destroy_link_click(a)},this))},b.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),this.is_disabled?b.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(a(b.target)))},b.prototype.choice_destroy=function(a){return this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),this.result_deselect(a.attr("rel")),a.parents("li").first().remove()},b.prototype.results_reset=function(b){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.show_search_field_default(),a(b.target).remove(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},b.prototype.result_select=function(a){var b,c,d,e;return this.result_highlight?(b=this.result_highlight,c=b.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(b):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=b),b.addClass("result-selected"),e=c.substr(c.lastIndexOf("_")+1),d=this.results_data[e],d.selected=!0,this.form_field.options[d.options_index].selected=!0,this.is_multiple?this.choice_build(d):(this.selected_item.find("span").first().text(d.text),this.allow_single_deselect&&this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')),a.metaKey&&this.is_multiple||this.results_hide(),this.search_field.val(""),this.form_field_jq.trigger("change"),this.search_field_scale()):void 0},b.prototype.result_activate=function(a){return a.addClass("active-result")},b.prototype.result_deactivate=function(a){return a.removeClass("active-result")},b.prototype.result_deselect=function(b){var c,d;return d=this.results_data[b],d.selected=!1,this.form_field.options[d.options_index].selected=!1,c=a("#"+this.container_id+"_o_"+b),c.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change"),this.search_field_scale()},b.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},b.prototype.winnow_results=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(j=new Date,this.no_results_clear(),h=0,i=this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html(),f=new RegExp("^"+i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),m=new RegExp(i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),r=this.results_data,n=0,p=r.length;p>n;n++)if(c=r[n],!c.disabled&&!c.empty)if(c.group)a("#"+c.dom_id).hide();else if(!this.is_multiple||!c.selected){if(b=!1,g=c.dom_id,f.test(c.html))b=!0,h+=1;else if((c.html.indexOf(" ")>=0||0===c.html.indexOf("["))&&(e=c.html.replace(/\[|\]/g,"").split(" "),e.length))for(o=0,q=e.length;q>o;o++)d=e[o],f.test(d)&&(b=!0,h+=1);b?(i.length?(k=c.html.search(m),l=c.html.substr(0,k+i.length)+"</em>"+c.html.substr(k+i.length),l=l.substr(0,k)+"<em>"+l.substr(k)):l=c.html,a("#"+g).html!==l&&a("#"+g).html(l),this.result_activate(a("#"+g)),null!=c.group_array_index&&a("#"+this.results_data[c.group_array_index].dom_id).show()):(this.result_highlight&&g===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(a("#"+g)))}return 1>h&&i.length?this.no_results(i):this.winnow_results_set_highlight()},b.prototype.winnow_results_clear=function(){var b,c,d,e,f;for(this.search_field.val(""),c=this.search_results.find("li"),f=[],d=0,e=c.length;e>d;d++)b=c[d],b=a(b),f.push(b.hasClass("group-result")?b.show():this.is_multiple&&b.hasClass("result-selected")?void 0:this.result_activate(b));return f},b.prototype.winnow_results_set_highlight=function(){var a,b;return this.result_highlight||(b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first(),null==a)?void 0:this.result_do_highlight(a)},b.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c)},b.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},b.prototype.keydown_arrow=function(){var b,c;return this.result_highlight?this.results_showing&&(c=this.result_highlight.nextAll("li.active-result").first(),c&&this.result_do_highlight(c)):(b=this.search_results.find("li.active-result").first(),b&&this.result_do_highlight(a(b))),this.results_showing?void 0:this.results_show()},b.prototype.keyup_arrow=function(){var a;return this.results_showing||this.is_multiple?this.result_highlight?(a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},b.prototype.keydown_backstroke=function(){return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(this.pending_backstroke=this.search_container.siblings("li.search-choice").last(),this.pending_backstroke.addClass("search-choice-focus"))},b.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},b.prototype.keyup_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:if(this.results_showing)return this.results_hide();break;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},b.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},b.prototype.search_field_scale=function(){var b,c,d,e,f,g,h,i,j;if(this.is_multiple){for(d=0,h=0,f="position:absolute; left: -1000px; top: -1000px; display:none;",g=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],i=0,j=g.length;j>i;i++)e=g[i],f+=e+":"+this.search_field.css(e)+";";return c=a("<div />",{style:f}),c.text(this.search_field.val()),a("body").append(c),h=c.width()+25,c.remove(),h>this.f_width-10&&(h=this.f_width-10),this.search_field.css({width:h+"px"}),b=this.container.height(),this.dropdown.css({top:b+"px"})}},b.prototype.generate_field_id=function(){var a;return a=this.generate_random_id(),this.form_field.id=a,a},b.prototype.generate_random_id=function(){var b;for(b="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();a("#"+b).length>0;)b+=this.generate_random_char();return b},b.prototype.generate_random_char=function(){var a,b,c;return a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ",c=Math.floor(Math.random()*a.length),b=a.substring(c,c+1)},b}(),c=function(a){var b;return b=a.outerWidth()-a.width()},d.get_side_border_padding=c}.call(this),function(){var a;a=function(){function a(){this.options_index=0,this.parsed=[]}return a.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName?this.add_group(a):this.add_option(a)},a.prototype.add_group=function(a){var b,c,d,e,f,g;for(b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:a.label,children:0,disabled:a.disabled}),f=a.childNodes,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},a.prototype.add_option=function(a,b,c){return"OPTION"===a.nodeName?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},a}(),a.select_to_array=function(b){var c,d,e,f,g;for(d=new a,g=b.childNodes,e=0,f=g.length;f>e;e++)c=g[e],d.add_node(c);return d.parsed},this.SelectParser=a}.call(this),function(a,b,c){"use strict";function d(b,c){this.name=e,this.el=b,this.$el=a(b),this.options=a.extend({},f,c),this.$document=a(this.$el[0].ownerDocument),this.$body=this.$document.find("body"),this.moveTrigger="MSPointerMove touchmove mousemove",this.startTrigger="MSPointerDown touchstart mousedown",this.stopTrigger="MSPointerUp touchend mouseup",this.startTriggerArray=this.startTrigger.split(" "),this.moveTriggerArray=this.moveTrigger.split(" "),this.stopTriggerArray=this.stopTrigger.split(" "),this.stopEvents=[this.stopTrigger,this.options.stopEvents].join(" "),this.$container="window"===this.options.constrainTo?this.$document:this.options.constrainTo&&"parent"!==this.options.constrainTo?a(this.options.constrainTo):this.$el.parent(),this.isPointerEventCompatible()&&this.applyMSDefaults(),this.CSSEaseHash=this.getCSSEaseHash(),this.scale=1,this.started=!1,this.disabled=!1,this.resetVelocityQueue(),this.init()}var e="pep",f={initiate:function(){},start:function(){},drag:function(){},stop:function(){},rest:function(){},moveTo:!1,callIfNotStarted:["stop","rest"],startThreshold:[0,0],grid:[1,1],debug:!1,activeClass:"pep-active",multiplier:1,velocityMultiplier:2.5,shouldPreventDefault:!0,allowDragEventPropagation:!0,stopEvents:"",hardwareAccelerate:!0,useCSSTranslation:!0,disableSelect:!0,cssEaseString:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",cssEaseDuration:1e3,shouldEase:!0,droppable:!1,droppableActiveClass:"pep-dpa",overlapFunction:!1,constrainTo:!1,removeMargins:!0,place:!0,deferPlacement:!1,axis:null,forceNonCSS3Movement:!1,elementsWithInteraction:"input"};d.prototype.init=function(){this.options.debug&&this.buildDebugDiv(),this.options.disableSelect&&this.disableSelect(),this.options.place&&!this.options.deferPlacement&&(this.positionParent(),this.placeObject()),this.ev={},this.pos={},this.subscribe()},d.prototype.subscribe=function(){var a=this;this.$el.on(this.startTrigger,function(b){a.handleStart(b)}),this.$el.on(this.startTrigger,this.options.elementsWithInteraction,function(a){a.stopPropagation()}),this.$document.on(this.stopEvents,function(b){a.handleStop(b)}),this.$document.on(this.moveTrigger,function(b){a.moveEvent=b})},d.prototype.handleStart=function(b){var c=this;if(this.isValidMoveEvent(b)&&!this.disabled){this.isPointerEventCompatible()&&b.preventManipulation&&b.preventManipulation(),b=this.normalizeEvent(b),this.options.place&&this.options.deferPlacement&&(this.positionParent(),this.placeObject()),this.log({type:"event",event:b.type}),this.options.hardwareAccelerate&&!this.hardwareAccelerated&&(this.hardwareAccelerate(),this.hardwareAccelerated=!0);var d=this.options.initiate.call(this,b,this);if(d===!1)return;clearTimeout(this.restTimeout),this.$el.addClass(this.options.activeClass),this.removeCSSEasing(),this.startX=this.ev.x=b.pep.x,this.startY=this.ev.y=b.pep.y,this.startEvent=this.moveEvent=b,this.active=!0,this.options.shouldPreventDefault&&b.preventDefault(),this.options.allowDragEventPropagation||b.stopPropagation(),function e(){c.active&&(c.handleMove(),c.requestAnimationFrame(e))}(a,c)}},d.prototype.handleMove=function(){if("undefined"!=typeof this.moveEvent){var c=this.normalizeEvent(this.moveEvent),d=b.parseInt(c.pep.x/this.options.grid[0])*this.options.grid[0],e=b.parseInt(c.pep.y/this.options.grid[1])*this.options.grid[1];this.addToLIFO({time:c.timeStamp,x:d,y:e});var f,g;if(a.inArray(c.type,this.startTriggerArray)>-1?(f=0,g=0):(f=d-this.ev.x,g=e-this.ev.y),this.dx=f,this.dy=g,this.ev.x=d,this.ev.y=e,0===f&&0===g)return this.log({type:"event",event:"** stopped **"}),void 0;
var h=Math.abs(this.startX-d),i=Math.abs(this.startY-e);!this.started&&(h>this.options.startThreshold[0]||i>this.options.startThreshold[1])&&(this.started=!0,this.$el.addClass("pep-start"),this.options.start.call(this,this.startEvent,this)),this.options.droppable&&this.calculateActiveDropRegions();var j=this.options.drag.call(this,c,this);if(j===!1)return this.resetVelocityQueue(),void 0;this.log({type:"event",event:c.type}),this.log({type:"event-coords",x:this.ev.x,y:this.ev.y}),this.log({type:"velocity"});var k,l,m=this.handleConstraint(f,g);"function"==typeof this.options.moveTo?(k=f>=0?"+="+Math.abs(f/this.scale)*this.options.multiplier:"-="+Math.abs(f/this.scale)*this.options.multiplier,l=g>=0?"+="+Math.abs(g/this.scale)*this.options.multiplier:"-="+Math.abs(g/this.scale)*this.options.multiplier,this.options.constrainTo&&(k=m.x!==!1?m.x:k,l=m.y!==!1?m.y:l),"x"===this.options.axis&&(l=m.y),"y"===this.options.axis&&(k=m.x),this.options.moveTo.call(this,k,l)):this.shouldUseCSSTranslation()?(f=f/this.scale*this.options.multiplier,g=g/this.scale*this.options.multiplier,this.options.constrainTo&&(f=m.x===!1?f:0,g=m.y===!1?g:0),"x"===this.options.axis&&(g=0),"y"===this.options.axis&&(f=0),this.moveToUsingTransforms(f,g)):(k=f>=0?"+="+Math.abs(f/this.scale)*this.options.multiplier:"-="+Math.abs(f/this.scale)*this.options.multiplier,l=g>=0?"+="+Math.abs(g/this.scale)*this.options.multiplier:"-="+Math.abs(g/this.scale)*this.options.multiplier,this.options.constrainTo&&(k=m.x!==!1?m.x:k,l=m.y!==!1?m.y:l),"x"===this.options.axis&&(l=m.y),"y"===this.options.axis&&(k=m.x),this.moveTo(k,l))}},d.prototype.handleStop=function(b){this.active&&(this.log({type:"event",event:b.type}),this.active=!1,this.$el.removeClass("pep-start").addClass("pep-ease"),this.options.droppable&&this.calculateActiveDropRegions(),(this.started||!this.started&&a.inArray("stop",this.options.callIfNotStarted)>-1)&&this.options.stop.call(this,b,this),this.options.shouldEase&&this.ease(b,this.started),this.started=!1,this.resetVelocityQueue())},d.prototype.ease=function(b,c){var d=(this.$el.position(),this.velocity()),e=(this.dt,d.x/this.scale*this.options.multiplier),f=d.y/this.scale*this.options.multiplier,g=this.handleConstraint(e,f,!0);this.cssAnimationsSupported()&&this.$el.css(this.getCSSEaseHash());var h=d.x>0?"+="+e:"-="+Math.abs(e),i=d.y>0?"+="+f:"-="+Math.abs(f);this.options.constrainTo&&(h=g.x!==!1?g.x:h,i=g.y!==!1?g.y:i),"x"===this.options.axis&&(i="+=0"),"y"===this.options.axis&&(h="+=0");var j=!this.cssAnimationsSupported()||this.options.forceNonCSS3Movement;"function"==typeof this.options.moveTo?this.options.moveTo.call(this,h,i):this.moveTo(h,i,j);var k=this;this.restTimeout=setTimeout(function(){k.options.droppable&&k.calculateActiveDropRegions(),(c||!c&&a.inArray("rest",k.options.callIfNotStarted)>-1)&&k.options.rest.call(k,b,k),k.$el.removeClass([k.options.activeClass,"pep-ease"].join(" "))},this.options.cssEaseDuration)},d.prototype.normalizeEvent=function(a){return a.pep={},this.isPointerEventCompatible()||!this.isTouch(a)?(a.pageX?(a.pep.x=a.pageX,a.pep.y=a.pageY):(a.pep.x=a.originalEvent.pageX,a.pep.y=a.originalEvent.pageY),a.pep.type=a.type):(a.pep.x=a.originalEvent.touches[0].pageX,a.pep.y=a.originalEvent.touches[0].pageY,a.pep.type=a.type),a},d.prototype.resetVelocityQueue=function(){this.velocityQueue=new Array(5)},d.prototype.moveTo=function(a,b,c){this.log({type:"delta",x:a,y:b}),c?this.$el.animate({top:b,left:a},this.options.cssEaseDuration/2,"easeOutQuad",{queue:!1}):this.$el.stop(!0,!1).css({top:b,left:a})},d.prototype.moveToUsingTransforms=function(a,b){var c=this.matrixToArray(this.matrixString());this.cssX||(this.cssX=this.xTranslation(c)),this.cssY||(this.cssY=this.yTranslation(c)),this.cssX=this.cssX+a,this.cssY=this.cssY+b,this.log({type:"delta",x:a,y:b}),c[4]=this.cssX,c[5]=this.cssY,this.translation=this.arrayToMatrix(c),this.transform(this.translation)},d.prototype.transform=function(a){this.$el.css({"-webkit-transform":a,"-moz-transform":a,"-ms-transform":a,"-o-transform":a,transform:a})},d.prototype.xTranslation=function(a){return a=a||this.matrixToArray(this.matrixString()),parseInt(a[4],10)},d.prototype.yTranslation=function(a){return a=a||this.matrixToArray(this.matrixString()),parseInt(a[5],10)},d.prototype.matrixString=function(){var a=function(a){return!(!a||"none"===a||a.indexOf("matrix")<0)},b="matrix(1, 0, 0, 1, 0, 0)";return a(this.$el.css("-webkit-transform"))&&(b=this.$el.css("-webkit-transform")),a(this.$el.css("-moz-transform"))&&(b=this.$el.css("-moz-transform")),a(this.$el.css("-ms-transform"))&&(b=this.$el.css("-ms-transform")),a(this.$el.css("-o-transform"))&&(b=this.$el.css("-o-transform")),a(this.$el.css("transform"))&&(b=this.$el.css("transform")),b},d.prototype.matrixToArray=function(a){return a.split("(")[1].split(")")[0].split(",")},d.prototype.arrayToMatrix=function(a){return"matrix("+a.join(",")+")"},d.prototype.addToLIFO=function(a){var b=this.velocityQueue;b=b.slice(1,b.length),b.push(a),this.velocityQueue=b},d.prototype.velocity=function(){for(var a=0,b=0,c=0;c<this.velocityQueue.length-1;c++)this.velocityQueue[c]&&(a+=this.velocityQueue[c+1].x-this.velocityQueue[c].x,b+=this.velocityQueue[c+1].y-this.velocityQueue[c].y,this.dt=this.velocityQueue[c+1].time-this.velocityQueue[c].time);return{x:a*this.options.velocityMultiplier,y:b*this.options.velocityMultiplier}},d.prototype.requestAnimationFrame=function(a){return b.requestAnimationFrame&&b.requestAnimationFrame(a)||b.webkitRequestAnimationFrame&&b.webkitRequestAnimationFrame(a)||b.mozRequestAnimationFrame&&b.mozRequestAnimationFrame(a)||b.oRequestAnimationFrame&&b.mozRequestAnimationFrame(a)||b.msRequestAnimationFrame&&b.msRequestAnimationFrame(a)||b.setTimeout(a,1e3/60)},d.prototype.positionParent=function(){this.options.constrainTo&&!this.parentPositioned&&(this.parentPositioned=!0,"parent"===this.options.constrainTo?this.$container.css({position:"relative"}):"window"===this.options.constrainTo&&"#document"!==this.$container.get(0).nodeName&&"static"!==this.$container.css("position")&&this.$container.css({position:"static"}))},d.prototype.placeObject=function(){this.objectPlaced||(this.objectPlaced=!0,this.offset="parent"===this.options.constrainTo||this.hasNonBodyRelative()?this.$el.position():this.$el.offset(),parseInt(this.$el.css("left"),10)&&(this.offset.left=this.$el.css("left")),parseInt(this.$el.css("top"),10)&&(this.offset.top=this.$el.css("top")),this.options.removeMargins&&this.$el.css({margin:0}),this.$el.css({position:"absolute",top:this.offset.top,left:this.offset.left}))},d.prototype.hasNonBodyRelative=function(){return this.$el.parents().filter(function(){var b=a(this);return b.is("body")||"relative"===b.css("position")}).length>1},d.prototype.setScale=function(a){this.scale=a},d.prototype.setMultiplier=function(a){this.options.multiplier=a},d.prototype.removeCSSEasing=function(){this.cssAnimationsSupported()&&this.$el.css(this.getCSSEaseHash(!0))},d.prototype.disableSelect=function(){this.$el.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"})},d.prototype.handleConstraint=function(b,d,e){var f=this.$el.position();this.pos.x=f.left,this.pos.y=f.top;var g,h,i,j,k={x:!1,y:!1};return this.log({type:"pos-coords",x:this.pos.x,y:this.pos.y}),a.isArray(this.options.constrainTo)?(this.options.constrainTo[3]!==c&&this.options.constrainTo[1]!==c&&(h=this.options.constrainTo[1]===!1?1/0:this.options.constrainTo[1],i=this.options.constrainTo[3]===!1?-1/0:this.options.constrainTo[3]),this.options.constrainTo[0]!==!1&&this.options.constrainTo[2]!==!1&&(g=this.options.constrainTo[2]===!1?1/0:this.options.constrainTo[2],j=this.options.constrainTo[0]===!1?-1/0:this.options.constrainTo[0]),this.pos.x+b<i&&(k.x=i),this.pos.y+d<j&&(k.y=j)):"string"==typeof this.options.constrainTo&&(i=0,j=0,h=this.$container.width()-this.$el.outerWidth(),g=this.$container.height()-this.$el.outerHeight(),this.pos.x+b<0&&(k.x=0),this.pos.y+d<0&&(k.y=0)),this.pos.x+b>h&&(k.x=h),this.pos.y+d>g&&(k.y=g),this.shouldUseCSSTranslation()&&e&&(k.x===i&&this.xTranslation()&&(k.x=i-this.xTranslation()),k.x===h&&this.xTranslation()&&(k.x=h-this.xTranslation()),k.y===j&&this.yTranslation()&&(k.y=j-this.yTranslation()),k.y===g&&this.yTranslation()&&(k.y=g-this.yTranslation())),k},d.prototype.getCSSEaseHash=function(a){"undefined"==typeof a&&(a=!1);var b;if(a)b="";else{if(this.CSSEaseHash)return this.CSSEaseHash;b=["all",this.options.cssEaseDuration+"ms",this.options.cssEaseString].join(" ")}return{"-webkit-transition":b,"-moz-transition":b,"-ms-transition":b,"-o-transition":b,transition:b}},d.prototype.calculateActiveDropRegions=function(){var b=this;this.activeDropRegions=[],a.each(a(this.options.droppable),function(c,d){var e=a(d);b.isOverlapping(e,b.$el)?(e.addClass(b.options.droppableActiveClass),b.activeDropRegions.push(e)):e.removeClass(b.options.droppableActiveClass)})},d.prototype.isOverlapping=function(a,b){if(this.options.overlapFunction)return this.options.overlapFunction(a,b);var c=a[0].getBoundingClientRect(),d=b[0].getBoundingClientRect();return!(c.right<d.left||c.left>d.right||c.bottom<d.top||c.top>d.bottom)},d.prototype.isTouch=function(a){return a.type.search("touch")>-1},d.prototype.isPointerEventCompatible=function(){return"MSPointerEvent"in b},d.prototype.applyMSDefaults=function(){this.$body.css({"-ms-touch-action":"none","touch-action":"none","-ms-scroll-chaining":"none","-ms-scroll-limit":"0 0 0 0",overflow:"hidden"})},d.prototype.isValidMoveEvent=function(a){return!this.isTouch(a)||this.isTouch(a)&&a.originalEvent.touches&&1===a.originalEvent.touches.length},d.prototype.shouldUseCSSTranslation=function(){if("undefined"!=typeof this.useCSSTranslation)return this.useCSSTranslation;var a=!1;return a=!this.options.useCSSTranslation||"undefined"!=typeof Modernizr&&!Modernizr.csstransforms?!1:!0,this.useCSSTranslation=a,a},d.prototype.cssAnimationsSupported=function(){if("undefined"!=typeof this.cssAnimationsSupport)return this.cssAnimationsSupport;if("undefined"!=typeof Modernizr&&Modernizr.cssanimations)return this.cssAnimationsSupport=!0,!0;var a=!1,b=document.createElement("div"),d="animation",e="",f="Webkit Moz O ms Khtml".split(" "),g="";if(b.style.animationName&&(a=!0),a===!1)for(var h=0;h<f.length;h++)if(b.style[f[h]+"AnimationName"]!==c){g=f[h],d=g+"Animation",e="-"+g.toLowerCase()+"-",a=!0;break}return this.cssAnimationsSupport=a,a},d.prototype.hardwareAccelerate=function(){this.$el.css({"-webkit-perspective":1e3,perspective:1e3,"-webkit-backface-visibility":"hidden","backface-visibility":"hidden"})},d.prototype.getMovementValues=function(){return{ev:this.ev,pos:this.pos,velocity:this.velocity()}},d.prototype.buildDebugDiv=function(){var b;0===a("#pep-debug").length&&(b=a("<div></div>"),b.attr("id","pep-debug").append("<div style='font-weight:bold; background: red; color: white;'>DEBUG MODE</div>").append("<div id='pep-debug-event'>no event</div>").append("<div id='pep-debug-ev-coords'>event coords: <span class='pep-x'>-</span>, <span class='pep-y'>-</span></div>").append("<div id='pep-debug-pos-coords'>position coords: <span class='pep-x'>-</span>, <span class='pep-y'>-</span></div>").append("<div id='pep-debug-velocity'>velocity: <span class='pep-x'>-</span>, <span class='pep-y'>-</span></div>").append("<div id='pep-debug-delta'>&Delta; movement: <span class='pep-x'>-</span>, <span class='pep-y'>-</span></div>").css({position:"fixed",bottom:5,right:5,zIndex:99999,textAlign:"right",fontFamily:"Arial, sans",fontSize:10,border:"1px solid #DDD",padding:"3px",background:"white",color:"#333"}));var c=this;setTimeout(function(){c.debugElements={$event:a("#pep-debug-event"),$velocityX:a("#pep-debug-velocity .pep-x"),$velocityY:a("#pep-debug-velocity .pep-y"),$dX:a("#pep-debug-delta .pep-x"),$dY:a("#pep-debug-delta .pep-y"),$evCoordsX:a("#pep-debug-ev-coords .pep-x"),$evCoordsY:a("#pep-debug-ev-coords .pep-y"),$posCoordsX:a("#pep-debug-pos-coords .pep-x"),$posCoordsY:a("#pep-debug-pos-coords .pep-y")}},0),a("body").append(b)},d.prototype.log=function(a){if(this.options.debug)switch(a.type){case"event":this.debugElements.$event.text(a.event);break;case"pos-coords":this.debugElements.$posCoordsX.text(a.x),this.debugElements.$posCoordsY.text(a.y);break;case"event-coords":this.debugElements.$evCoordsX.text(a.x),this.debugElements.$evCoordsY.text(a.y);break;case"delta":this.debugElements.$dX.text(a.x),this.debugElements.$dY.text(a.y);break;case"velocity":var b=this.velocity();this.debugElements.$velocityX.text(Math.round(b.x)),this.debugElements.$velocityY.text(Math.round(b.y))}},d.prototype.toggle=function(a){this.disabled="undefined"==typeof a?!this.disabled:!a},a.extend(a.easing,{easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeOutExpo:function(a,b,c,d,e){return b===e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c}}),a.fn[e]=function(b){return this.each(function(){if(!a.data(this,"plugin_"+e)){var c=new d(this,b);a.data(this,"plugin_"+e,c),a.pep.peps.push(c)}})},a.pep={},a.pep.peps=[],a.pep.toggleAll=function(b){a.each(this.peps,function(a,c){c.toggle(b)})},a.pep.unbind=function(a){var b=a.data("plugin_"+e);"undefined"!=typeof b&&(b.toggle(!1),a.removeData("plugin_"+e))}}(jQuery,window),ccm_t=function(a){return $("input[name=ccm-string-"+a+"]").val()},ccm_parseJSON=function(a,b){a.error?alert(a.message):b()},ccm_addHeaderItem=function(a,b){var c=-1!=a.indexOf("?")?"":"?ts=";if("CSS"==b)if(-1!=navigator.userAgent.indexOf("MSIE")){var d=document.createElement("link"),e=document.getElementsByTagName("head")[0];d.type="text/css",d.rel="stylesheet",d.href=a,d.media="screen",e.appendChild(d)}else $("head").children('link[href*="'+a+'"]').length||$("head").append('<link rel="stylesheet" media="screen" type="text/css" href="'+a+c+(new Date).getTime()+'" />');else"JAVASCRIPT"==b?$('script[src*="'+a+'"]').length||$("head").append('<script type="text/javascript" src="'+a+c+(new Date).getTime()+'"></script>'):$("head").children(a).length||$("head").append(a)};var ccm_isBlockError=!1,ccm_blockError=!1;ccm_addError=function(a){ccm_isBlockError||(ccm_blockError="",ccm_blockError+="<ul>"),ccm_isBlockError=!0,ccm_blockError+="<li>"+a+"</li>"},ccm_resetBlockErrors=function(){ccm_isBlockError=!1,ccm_blockError=""},ccm_fadeInMenu=function(a,b){var c=a.find("div.popover div.inner").width(),d=a.find("div.popover").height();a.hide(),a.css("visibility","visible");var e=b.pageX+2,f=b.pageY+2;$(window).height()<b.clientY+d?(f=f-d-10,e-=c/2,a.find("div.popover").removeClass("below"),a.find("div.popover").addClass("above")):(e-=c/2,f+=10,a.find("div.popover").removeClass("above"),a.find("div.popover").addClass("below")),a.css("top",f+"px"),a.css("left",e+"px"),a.fadeIn(60)},ccm_hideMenus=function(){ccm_activeMenu=!1,$("div.ccm-menu").hide(),$("div.ccm-menu").css("visibility","hidden"),$("div.ccm-menu").show()},ccm_paneToggleOptions=function(a){var b=$(a).parent().find("div.ccm-pane-options-content");$(a).hasClass("ccm-icon-option-closed")?($(a).removeClass("ccm-icon-option-closed").addClass("ccm-icon-option-open"),b.slideDown("fast","easeOutExpo")):($(a).removeClass("ccm-icon-option-open").addClass("ccm-icon-option-closed"),b.slideUp("fast","easeOutExpo"))},function(a,b,c,d){"use strict";var e=d.EditMode=function(){var e,h,i=this;d.createGetterSetters.call(i,{dragging:!1,areas:[],blocks:[],selectedCache:[],selectedThreshold:5,dragAreaBlacklist:[]}),d.event.bind("panel.open",function(a){i.panelOpened(a.eventData)}),d.event.bind("EditModeBlockEditInline",function(c){var d=c.eventData,e=d.block,f=e.getArea();a.CCMInlineEditMode.editBlock(CCM_CID,f.getId(),f.getHandle(),e.getId(),b(this).data("menu-action-params"))}),d.event.bind("EditModeBlockAddToClipboard",function(b){var c=b.eventData,d=c.block,e=d.getArea();a.CCMEditMode.addBlockToScrapbook(CCM_CID,d.getId(),e.getHandle())}),d.event.bind("EditModeBlockDelete",function(b){var c=b.eventData,d=c.block,e=d.getArea(),f=c.message;a.CCMEditMode.deleteBlock(CCM_CID,d.getId(),e.getId(),e.getHandle(),f)}),d.event.bind("EditModeBlockDrag",c.throttle(function(a){if(i.getDragging()){var b=a.eventData,e=b.block,f=b.pep,g=c.flatten(c(i.getAreas()).map(function(a){var b=a.contendingDragAreas(f,e);return b}),!0);c.defer(function(){d.event.fire("EditModeContenders",g),i.selectContender(f,e,g,b.event)})}},250,!0)),d.event.bind("EditModeBlockDragStop",function(){d.event.fire("EditModeContenders",[]),d.event.fire("EditModeSelectableContender"),i.setDragging(!1)}),d.event.bind("EditModeBlockMove",function(d){var e=d.eventData,f=e.getArea(),g={cID:CCM_CID,ccm_token:a.CCM_SECURITY_TOKEN,btask:"ajax_do_arrange",area:f.getId(),block:e.getId(),blocks:{}};c(f.getBlocks()).each(function(a,b){g.blocks[b]=a.getId()});var h=!1,i=setTimeout(function(){h=!0,b.fn.dialog.showLoader()},150);b.post(a.CCM_DISPATCHER_FILENAME,g,function(){h&&b.fn.dialog.hideLoader(),clearTimeout(i)})}),d.event.bind("EditModeBlockDragStart",function(){i.setDragging(!0)}),b("div.ccm-area").each(function(){e=new f(b(this),i),i.addArea(e)}),b("div.ccm-block-edit").each(function(){i.addBlock(h=new g(b(this),i)),c(i.getAreas()).findWhere({id:h.getAreaId()}).addBlock(h)})},f=d.Area=function(a,b){var c=this;d.createGetterSetters.call(c,{id:a.data("area-id"),elem:a,handle:a.data("area-handle"),dragAreas:[],blocks:[],editMode:b,blockTypes:a.data("accepts-block-types").split(" ")}),c.id=c.getId(),c.addDragArea(),a.ccmmenu()},g=d.Block=function(e,f){var g=this;d.createGetterSetters.call(g,{id:e.data("block-id"),handle:e.data("block-type-handle"),areaId:e.data("area-id"),area:null,elem:e,dragger:null,draggerOffset:{x:0,y:0},draggerPosition:{x:0,y:0},dragging:!1,rotationDeg:0,editMode:f,selected:null,stepIndex:0,peper:e.find('a[data-inline-command="move-block"]'),pepSettings:{}}),g.id=g.getId(),e.ccmmenu(),e.find("a[data-menu-action=edit_inline]").on("click",function(){d.event.fire("EditModeBlockEditInline",{block:g,event:event})}),e.find("a[data-menu-action=block_dialog]").each(function(){var a=b(this).attr("data-menu-href"),c=f.getAreaByID(g.getAreaId());a+=-1!==a.indexOf("?")?"&cID="+CCM_CID:"?cID="+CCM_CID,a+="&arHandle="+encodeURIComponent(c.getHandle())+"&bID="+g.getId(),b(this).attr("href",a),b(this).dialog()}),e.find("a[data-menu-action=block_scrapbook]").on("click",function(){d.event.fire("EditModeBlockAddToClipboard",{block:g,event:event})}),e.find("a[data-menu-action=delete_block]").on("click",function(){d.event.fire("EditModeBlockDelete",{message:b(this).attr("data-menu-delete-message"),block:g,event:event})}),c(g.getPepSettings()).extend({deferPlacement:!0,moveTo:function(){g.dragPosition(this)},initiate:function(b,e){g.setDragging(!0),g.getDragger().hide().appendTo(a.document.body).css(g.getElem().offset()),g.setDraggerOffset({x:b.clientX-g.getElem().offset().left+a.document.body.scrollLeft,y:b.clientY-g.getElem().offset().top+a.document.body.scrollTop}),g.getDragger().fadeIn(250),c.defer(function(){d.event.fire("EditModeBlockDragInitialization",{block:g,pep:e,event:b})})},drag:function(a,b){c.defer(function(){d.event.fire("EditModeBlockDrag",{block:g,pep:b,event:a})})},start:function(b,e){g.getDragger().css({top:0,left:0}),g.setDraggerOffset({x:b.clientX-g.getElem().offset().left+a.document.body.scrollLeft,y:b.clientY-g.getElem().offset().top+a.document.body.scrollTop}),g.dragPosition(e);var f=g.getDraggerOffset(),h=g.getDragger().width();g.getDragger().animate({width:90,height:90},{duration:250,step:function(a,b){if("width"==b.prop){var c=h-a;g.setDraggerOffset({x:f.x-c,y:f.y}),g.dragPosition(e)}}}),c.defer(function(){d.event.fire("EditModeBlockDragStart",{block:g,pep:e,event:b})})},stop:function(a,b){var e;g.getDragger().stop(1),g.getDragger().css({top:0,left:0}),g.dragPosition(b),g.getSelected()&&(g.getArea().removeBlock(g),g.getSelected().getElem().after(g.getElem()),(e=g.getSelected().getBlock())?g.getSelected().getArea().addBlock(g,e):g.getSelected().getArea().addBlockToIndex(g,0),g.getPeper().pep(g.getPepSettings()),d.event.fire("EditModeBlockMove",g));var f={x:g.getDraggerPosition().x,y:g.getDragger().offset().top,width:g.getDragger().width(),height:g.getDragger().height()};g.setDragging(!1),g.getDragger().animate({ccm_perc:0},{duration:0,step:function(){}}).animate({ccm_perc:1,opacity:0},{duration:500,step:function(a,b){if("ccm_perc"==b.prop){var c={x:g.getElem().offset().left,y:g.getElem().offset().top,width:g.getElem().width(),height:g.getElem().height()},d={x:(c.x-f.x)*a,y:(c.y-f.y)*a,width:(c.width-f.width)*a,height:(c.height-f.height)*a};g.setDraggerPosition({x:f.x+d.x,y:f.y+d.y}),g.renderPosition(),g.getDragger().css({width:f.width+d.width,height:f.height+d.height})}else g.getDragger().css({opacity:a})},complete:function(){g.getDragger().remove(),g.setAttr("dragger",null)}}),c.defer(function(){d.event.fire("EditModeBlockDragStop",{block:g,pep:b,event:a})})},place:!1}),d.event.bind("EditModeSelectableContender",function(a){g.getDragging()&&a.eventData instanceof h?g.setSelected(a.eventData):g.getDragging()&&g.setSelected(null)}),g.getPeper().css("z-index","50000 !important").click(function(a){return a.preventDefault(),a.stopPropagation(),!1}).pep(g.getPepSettings())},h=d.DragArea=function(a,b,e){var f=this;d.createGetterSetters.call(f,{block:e,elem:a,area:b,isContender:!1,isSelectable:!1,animationLength:500}),d.event.bind("EditModeContenders",function(a){var b=a.eventData;f.setIsContender(c.contains(b,f))}),d.event.bind("EditModeSelectableContender",function(a){f.setIsSelectable(a.eventData==f)})};e.prototype={panelOpened:function(a){return a},getAreaByID:function(a){return c(this.getAreas()).findWhere({id:a})},selectContender:function(a,b,e,f){var g=this;if(e=c(e).filter(function(c){return c.isSelectable(a,b,f)}),e.length<2)return d.event.fire("EditModeSelectableContender",c(e).first());var h=g.getSelectedCache(),i=g.getDragAreaBlacklist();g.getSelectedThreshold()!=h.length||c(h).without(c(h).last()).length||(i.push(c(h).last()),g.setDragAreaBlacklist(i),c.delay(function(a){var b=g.getDragAreaBlacklist();g.setDragAreaBlacklist(c(b).without(a))},5e3,c(h).last())),e=c(e).difference(i);var j=c(e).min(function(a){var b=a.centerDistanceToBlock(this);return b},b);return h.push(j),g.setSelectedCache(c(h).last(g.getSelectedThreshold())),d.event.fire("EditModeSelectableContender",j),j},addArea:function(a){var b=this;b.getAreas().push(a)},addBlock:function(a){var b=this;b.getBlocks().push(a)}},f.prototype={addBlock:function(a,b){var d=this;return b?this.addBlockToIndex(a,c(d.getBlocks()).indexOf(b)):(a.setArea(d),d.getBlocks().push(a),d.addDragArea(a),!0)},addBlockToIndex:function(a,b){return a.setArea(this),this.getBlocks().splice(b,0,a),!0},removeBlock:function(a){var b=this;a.getElem().remove(),b.setBlocks(c(b.getBlocks()).without(a));var d=c.first(c(b.getDragAreas()).filter(function(b){return b.getBlock()==a}));return d&&(d.getElem().remove(),b.setDragAreas(c(b.getDragAreas()).without(d))),!0},addDragArea:function(a){var c,d,e=this;if(a)c=b('<div class="ccm-area-drag-area"/>'),d=new h(c,e,a),a.getElem().after(c);else{if(e.getDragAreas().length)throw new Error("No block supplied");c=b('<div class="ccm-area-drag-area"/>'),d=new h(c,e,a),e.getElem().prepend(c)}return e.getDragAreas().push(d),d},contendingDragAreas:function(a,b){var d=this;return c(d.getBlockTypes()).contains(b.getHandle())?c(d.getDragAreas()).filter(function(c){return c.isContender(a,b)}):[]}},g.prototype={getDragger:function(){var a=this;if(!a.getAttr("dragger")){var c=b('<a><p><img src="/concrete/blocks/content/icon.png"><span>Content</span></p></a>').addClass("ccm-block-edit-drag").addClass("ccm-panel-add-block-draggable-block-type");a.setAttr("dragger",c.css({width:a.getElem().width(),height:a.getElem().height()}))}return a.getAttr("dragger")},transform:function(a,b){var c=this,d=c.getDragger().css({"-webkit-transform":a,"-moz-transform":a,"-ms-transform":a,"-o-transform":a,transform:a}).get(0);return d.filters&&(d.filters["DXImageTransform.Microsoft.Matrix"]||(d.style.filter=(d.style.filter?"":" ")+"progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand')"),d.filters["DXImageTransform.Microsoft.Matrix"].M11=b.elements[0][0],d.filters["DXImageTransform.Microsoft.Matrix"].M12=b.elements[0][1],d.filters["DXImageTransform.Microsoft.Matrix"].M21=b.elements[1][0],d.filters["DXImageTransform.Microsoft.Matrix"].M22=b.elements[1][1],d.style.left=-(d.offsetWidth/2)+d.clientWidth/2+"px",d.style.top=-(d.offsetHeight/2)+d.clientHeight/2+"px"),!0},multiplyMatrices:function(a,b){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[0].length;e++){for(var f=0,g=0;g<a[0].length;g++)f+=a[d][g]*b[g][e];c[d][e]=f}}return c},matrixToCss:function(a){var b=[a[0][0],a[0][1],a[1][0],a[1][1],a[0][2],a[1][2]];return"matrix("+b.join(",")+")"},endRotation:function(){var a=this,b=a.getRotationDeg();a.getDragger().animate({rotation:0},{duration:1,step:function(){}});var c=a.setStepIndex(a.getStepIndex()+1);return a.getDragger().animate({rotation:a.getRotationDeg()},{queue:!1,duration:150,step:function(d){a.getStepIndex()==c&&(a.setRotationDeg(b-d),a.renderPosition())}},"easeOutElastic"),!0},renderPosition:function(){var a,b,d=this,e=d.getDraggerPosition().x,f=d.getDraggerPosition().y,g=d.getRotationDeg()*(Math.PI/180),h=c.bind(Math.cos,Math),i=c.bind(Math.sin,Math),j=[[1,0,e],[0,1,f],[0,0,1]];return g?(a=[[h(g),i(g),0],[-i(g),h(g),0],[0,0,1]],b=d.multiplyMatrices(j,a)):b=j,this.transform(d.matrixToCss(b),b)},dragPosition:function(a){var b=this;b.setRotationDeg(Math.max(-15,Math.min(15,a.velocity().x/15))),b.endRotation();var d=c.last(a.velocityQueue),e=b.getDraggerOffset();d||(d={x:b.getDragger().offset().left,y:b.getDragger().offset().top});var f=d.x-e.x,g=d.y-e.y;return b.setDraggerPosition({x:f,y:g}),b.renderPosition(),!0}},h.prototype={isSelectable:function(a,b){return a.isOverlapping(b.getDragger(),this.getElem())},setIsSelectable:function(a){var b=this;return a&&!b.getIsSelectable()?b.getElem().addClass("ccm-area-drag-area-selectable"):!a&&b.getIsSelectable()&&b.getElem().removeClass("ccm-area-drag-area-selectable"),b.setAttr("isSelectable",a),!0},isContender:function(a,b){var d=this;return c.identity(a),d.getBlock()!=b},setIsContender:function(a){var b=this;return a&&!b.getIsContender()?b.getElem().addClass("ccm-area-drag-area-contender"):!a&&b.getIsContender()&&b.getElem().removeClass("ccm-area-drag-area-contender"),b.setAttr("isContender",a),!0},centerDistanceToBlock:function(a){var b=this,c=a.getDragger(),d={x:c.offset().left+c.width()/2,y:c.offset().top+c.height()/2},e=b.getElem(),f={x:e.offset().left+e.width()/2,y:e.offset().top+e.height()/2};return Math.sqrt(Math.pow(Math.abs(d.x-f.x),2)+Math.pow(Math.abs(d.y-f.y),2))}}}(window,jQuery,_,c5);var CCMEditMode=function(){return addBlockType=function(a,b,c,d,e){var f=d.attr("data-btID"),g=parseInt(d.attr("data-supports-inline-add")),h=parseInt(d.attr("data-has-add-template"));if(CCMPanelManager.exitPanelMode(),h)g?CCMInlineEditMode.loadAdd(a,c,b,f):jQuery.fn.dialog.open({onClose:function(){$(document).trigger("blockWindowClose"),e&&jQuery.fn.dialog.closeAll()},width:parseInt(d.attr("data-dialog-width")),height:parseInt(d.attr("data-dialog-height"))+20,title:d.attr("data-dialog-title"),href:CCM_TOOLS_PATH+"/add_block_popup?cID="+a+"&btID="+f+"&arHandle="+encodeURIComponent(c)});else{var i=CCM_DISPATCHER_FILENAME+"?cID="+a+"&arHandle="+encodeURIComponent(c)+"&btID="+f+"&mode=edit&processBlock=1&add=1&ccm_token="+CCM_SECURITY_TOKEN;$.get(i,function(a){CCMEditMode.parseBlockResponse(a,!1,"add")})}},{start:function(){c5.editMode=new c5.EditMode},exitPreviewMode:function(){$("html").removeClass("ccm-panel-preview-mode"),$("#ccm-page-preview-frame").remove(),$("html").removeClass("ccm-page-preview-mode")},launchPageComposer:function(){$("a[data-launch-panel=page]").toggleClass("ccm-launch-panel-active"),CCMPanelManager.getByIdentifier("page").show(),ccm_event.subscribe("panel.open",function(a){var b=a.eventData;"page"==b.options.identifier&&$("#"+b.getDOMID()).find("[data-launch-panel-detail='page-composer']").click()})},setupBlockForm:function(a,b,c){a.ajaxForm({type:"POST",iframe:!0,beforeSubmit:function(){return $("input[name=ccm-block-form-method]").val("AJAX"),jQuery.fn.dialog.showLoader(),"function"==typeof window.ccmValidateBlockForm&&(r=window.ccmValidateBlockForm(),ccm_isBlockError)?(jQuery.fn.dialog.hideLoader(),ccm_blockError&&ccmAlert.notice(ccmi18n.error,ccm_blockError+"</ul>"),ccm_resetBlockErrors(),!1):void 0},success:function(a){CCMEditMode.parseBlockResponse(a,b,c)}})},addBlockToScrapbook:function(a,b,c){CCMToolbar.disableDirectExit(),$.ajax({type:"POST",url:CCM_TOOLS_PATH+"/pile_manager",data:"cID="+a+"&bID="+b+"&arHandle="+encodeURIComponent(c)+"&btask=add&scrapbookName=userScrapbook",success:function(){ccmAlert.hud(ccmi18n.copyBlockToScrapbookMsg,2e3,"add",ccmi18n.copyBlockToScrapbook)}})},deleteBlock:function(a,b,c,d,e,f){if(confirm(e)){CCMToolbar.disableDirectExit(),$d=$("[data-block-id="+b+"][data-area-id="+c+"]"),$d.hide().remove(),$.fn.ccmmenu.reset(),ccmAlert.hud(ccmi18n.deleteBlockMsg,2e3,"delete_small",ccmi18n.deleteBlock);var g=parseInt($("[data-area-id="+c+"]").attr("data-total-blocks"));$("[data-area-id="+c+"]").attr("data-total-blocks",g-1),CCMEditMode.start(),$.ajax({type:"POST",url:CCM_DISPATCHER_FILENAME,data:"cID="+a+"&ccm_token="+CCM_SECURITY_TOKEN+"&isAjax=true&btask=remove&bID="+b+"&arHandle="+encodeURIComponent(d)}),"function"==typeof f&&f()}},parseBlockResponse:function(r,currentBlockID,task){try{if("string"==typeof r?(r=r.replace(/(<([^>]+)>)/gi,""),resp=eval("("+r+")")):resp=r,1==resp.error){var message="<ul>";for(i=0;i<resp.response.length;i++)message+="<li>"+resp.response[i]+"</li>";message+="</ul>",ccmAlert.notice(ccmi18n.error,message)}else{jQuery.fn.dialog.closeTop(),$(document).trigger("blockWindowAfterClose"),cID=resp.cID?resp.cID:CCM_CID;var action=CCM_TOOLS_PATH+"/edit_block_popup?cID="+cID+"&bID="+resp.bID+"&arHandle="+encodeURIComponent(resp.arHandle)+"&btask=view_edit_mode";$.get(action,function(a){if("add"==task?$("#ccm-add-new-block-placeholder").length>0?($("#ccm-add-new-block-placeholder").before(a).remove(),saveArrangement(resp.bID,resp.aID,resp.aID)):$("#a"+resp.aID+" > div.ccm-area-block-list").append(a):$("[data-block-id="+currentBlockID+"][data-area-id="+resp.aID+"]").before(a).remove(),CCMInlineEditMode.exit(),CCMToolbar.disableDirectExit(),jQuery.fn.dialog.hideLoader(),"add"==task){var b=parseInt($("div.ccm-area[data-area-id="+resp.aID+"]").attr("data-total-blocks"));$("div.ccm-area[data-area-id="+resp.aID+"]").attr("data-total-blocks",b+1),ccmAlert.hud(ccmi18n.addBlockMsg,2e3,"ok",ccmi18n.addBlock),jQuery.fn.dialog.closeAll()}else ccmAlert.hud(ccmi18n.updateBlockMsg,2e3,"ok",ccmi18n.updateBlock);CCMEditMode.start(),$.fn.ccmmenu.reset(),"function"==typeof window.ccm_parseBlockResponsePost&&ccm_parseBlockResponsePost(resp)})}}catch(e){ccmAlert.notice(ccmi18n.error,r)}},launchLayoutPresets:function(a,b,c){var d=CCM_TOOLS_PATH+"/area/layout_presets?arLayoutID="+a+"&ccm_token="+b;c&&(d+="&task="+c),jQuery.fn.dialog.open({width:280,height:200,href:d,title:ccmi18n.areaLayoutPresets,onOpen:function(){$("#ccm-layout-save-preset-form select").on("change",function(){"-1"==$(this).val()?($("#ccm-layout-save-preset-name").show().focus(),$("#ccm-layout-save-preset-override").hide()):($("#ccm-layout-save-preset-name").hide(),$("#ccm-layout-save-preset-override").show())}).trigger("change"),$("#ccm-layout-save-preset-form").on("submit",function(){$.fn.dialog.showLoader();var a=$("#ccm-layout-save-preset-form").serializeArray();return a.push({name:"submit",value:1}),$.ajax({url:d,type:"POST",data:a,dataType:"json",success:function(){$.fn.dialog.hideLoader(),$.fn.dialog.closeAll()}}),!1})}})},showResponseNotification:function(a,b,c){$('<div id="ccm-notification-hud" class="ccm-ui ccm-notification ccm-notification-'+c+'"><i class="glyphicon glyphicon-'+b+'"></i><div class="ccm-notification-inner">'+a+"</div></div>").appendTo(document.body).delay(5).queue(function(){$(this).css("opacity",1),$(this).dequeue()
}).delay(2e3).queue(function(){$(this).css("opacity",0),$(this).dequeue()}).delay(1e3).queue(function(){$(this).remove(),$(this).dequeue()})},setupAjaxForm:function(a){return a.ajaxForm({type:"post",dataType:"json",beforeSubmit:function(){jQuery.fn.dialog.showLoader()},error:function(a){ccmAlert.notice("Error",'<div class="alert alert-danger">'+a.responseText+"</div>")},success:function(b){b.error?ccmAlert.notice("Error",'<div class="alert alert-danger">'+b.errors.join("<br>")+"</div>"):(a.attr("data-dialog-form")&&jQuery.fn.dialog.closeTop(),CCMEditMode.showResponseNotification(b.message,"ok","success"),CCMPanelManager.exitPanelMode(),b.redirectURL&&setTimeout(function(){window.location.href=b.redirectURL},2e3))},complete:function(){jQuery.fn.dialog.hideLoader()}}),a},activateAddBlocksPanel:function(){0==$("#ccm-panel-add-block-dragging").length&&$('<div id="ccm-panel-add-block-dragging" />').appendTo(document.body),$("#ccm-add-new-block-placeholder").remove(),$("#ccm-panel-add-block [data-panel-add-block-drag-item]").each(function(){var a=$(this);a.css("cursor","move"),a.draggable({helper:"clone",appendTo:$("#ccm-panel-add-block-dragging"),revert:!1,start:function(){$(".ccm-area-block-dropzone").addClass("ccm-area-block-dropzone-active"),$.fn.ccmmenu.disable()},stop:function(){$.fn.ccmmenu.enable()}})}),$("a[data-delete=clipboard-item]").on("click",function(){var a=$(this).parent(),b=a.attr("data-clipboard-item-id");a.addClass("ccm-panel-add-block-clipboard-item-delete").delay(500).queue(function(){$(this).remove(),$(this).dequeue()}),$.ajax({type:"POST",url:CCM_DISPATCHER_FILENAME,data:"pcID="+b+"&ptask=delete_content&ccm_token="+CCM_SECURITY_TOKEN})})}}}(),ccm_totalAdvancedSearchFields=0,ccm_alLaunchType=new Array,ccm_alActiveAssetField="",ccm_alProcessorTarget="",ccm_alDebug=!1;ccm_triggerSelectFile=function(a,b){if(null==b)var b=ccm_alActiveAssetField;var c=$("#"+b+"-fm-selected"),d=$("#"+b+"-fm-display");d.hide(),c.show(),c.load(CCM_TOOLS_PATH+"/files/selector_data?fID="+a+"&ccm_file_selected_field="+b,function(){c.attr("fID",a),c.attr("ccm-file-manager-can-view",c.children("div").attr("ccm-file-manager-can-view")),c.attr("ccm-file-manager-can-edit",c.children("div").attr("ccm-file-manager-can-edit")),c.attr("ccm-file-manager-can-admin",c.children("div").attr("ccm-file-manager-can-admin")),c.attr("ccm-file-manager-can-replace",c.children("div").attr("ccm-file-manager-can-replace")),c.attr("ccm-file-manager-instance",b),c.click(function(a){a.stopPropagation(),ccm_alActivateMenu($(this),a)}),"function"==typeof ccm_triggerSelectFileComplete&&ccm_triggerSelectFileComplete(a,b),ccm_event.publish("FileManagerFileSelected",{fID:a,af:b})});var e=$("#"+b+"-fm-value");e.attr("value",a),ccm_alSetupFileProcessor()},ccm_alGetFileData=function(a,b){$.getJSON(CCM_TOOLS_PATH+"/files/get_data.php?fID="+a,b)},ccm_clearFile=function(a,b){a.stopPropagation();var c=$("#"+b+"-fm-selected"),d=$("#"+b+"-fm-display"),e=$("#"+b+"-fm-value");e.attr("value",0),c.hide(),d.show()},ccm_activateFileManager=function(a,b){ccm_alLaunchType[b]=a,ccm_alSetupSelectFiles(b),$(document).click(function(a){a.stopPropagation(),ccm_alSelectNone()}),ccm_setupAdvancedSearch(b),"DASHBOARD"==a&&$(".dialog-launch").dialog(),ccm_alSetupCheckboxes(b),ccm_alSetupFileProcessor(),ccm_alSetupSingleUploadForm(),$("form#ccm-"+b+"-advanced-search select[name=fssID]").change(function(){if("DASHBOARD"==a)window.location.href=CCM_DISPATCHER_FILENAME+"/dashboard/files/search?fssID="+$(this).val();else{jQuery.fn.dialog.showLoader();var c=$("div#ccm-"+b+"-overlay-wrapper input[name=dialogAction]").val()+"&refreshDialog=1&fssID="+$(this).val();$.get(c,function(a){jQuery.fn.dialog.hideLoader(),$("div#ccm-"+b+"-overlay-wrapper").html(a),$("div#ccm-"+b+"-overlay-wrapper a.dialog-launch").dialog()})}}),ccm_searchActivatePostFunction[b]=function(){ccm_alSetupCheckboxes(b),ccm_alSetupSelectFiles(b),ccm_alSetupSingleUploadForm()}},ccm_alSetupSingleUploadForm=function(){$(".ccm-file-manager-submit-single").submit(function(){$(this).attr("target",ccm_alProcessorTarget),ccm_alSubmitSingle($(this).get(0))})},ccm_activateFileSelectors=function(){$(".ccm-file-manager-launch").unbind(),$(".ccm-file-manager-launch").click(function(){ccm_alLaunchSelectorFileManager($(this).parent().attr("ccm-file-manager-field"))})},ccm_alLaunchSelectorFileManager=function(a){ccm_alActiveAssetField=a;var b="",c=$("#"+a+"-fm-display input.ccm-file-manager-filter");if(c.length){var d,e={};for(i=0;i<c.length;i++)d=$(c[i]).attr("name"),d in e||(e[d]=[]),e[d].push($(c[i]).attr("value"));for(d in e)1==e[d].length?b+="&"+d+"="+encodeURIComponent(e[d][0]):$.each(e[d],function(a,c){b+="&"+d+"[]="+encodeURIComponent(c)})}ccm_launchFileManager(b)},ccm_launchFileManager=function(a){$.fn.dialog.open({width:"90%",height:"70%",appendButtons:!0,onOpen:function(){ccm_event.publish("launchFileManager",ccm_alActiveAssetField)},modal:!1,href:CCM_TOOLS_PATH+"/files/search_dialog?ocID="+CCM_CID+"&search=1"+a,title:ccmi18n_filemanager.title})},ccm_launchFileSetPicker=function(a){$.fn.dialog.open({width:500,height:160,modal:!1,href:CCM_TOOLS_PATH+"/files/pick_set?oldFSID="+a,title:ccmi18n_filemanager.sets})},ccm_alSubmitSetsForm=function(a){ccm_deactivateSearchResults(a),jQuery.fn.dialog.showLoader(),$("#ccm-"+a+"-add-to-set-form").ajaxSubmit(function(){jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.hideLoader(),$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(b){$("#ccm-"+a+"-sets-search-wrapper").load(CCM_TOOLS_PATH+"/files/search_sets_reload",{searchInstance:a},function(){$(".chosen-select").chosen(),ccm_parseAdvancedSearchResponse(b,a)})})})},ccm_alSubmitPasswordForm=function(a){ccm_deactivateSearchResults(a),$("#ccm-"+a+"-password-form").ajaxSubmit(function(){jQuery.fn.dialog.closeTop(),$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(b){ccm_parseAdvancedSearchResponse(b,a)})})},ccm_alSubmitStorageForm=function(a){ccm_deactivateSearchResults(a),$("#ccm-"+a+"-storage-form").ajaxSubmit(function(){jQuery.fn.dialog.closeTop(),$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(b){ccm_parseAdvancedSearchResponse(b,a)})})},ccm_alSubmitPermissionsForm=function(a){ccm_deactivateSearchResults(a),$("#ccm-"+a+"-permissions-form").ajaxSubmit(function(){jQuery.fn.dialog.closeTop(),$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(b){ccm_parseAdvancedSearchResponse(b,a)})})},ccm_alSetupSetsForm=function(a){$("#fsAddToSearchName").liveUpdate("ccm-file-search-add-to-sets-list","fileset"),$(".ccm-file-set-add-cb a").each(function(){var a=$(this),b=a.attr("ccm-tri-state-startup");$(this).click(function(){var a=$(this).attr("ccm-tri-state-selected"),c=0;switch(a){case"0":c="1"==b?"1":"2";break;case"1":c="2";break;case"2":c="0"}$(this).attr("ccm-tri-state-selected",c),$(this).parent().find("input").val(c),$(this).find("img").attr("src",CCM_IMAGE_PATH+"/checkbox_state_"+c+".png")})}),$("#ccm-"+a+"-add-to-set-form input[name=fsNew]").click(function(){$(this).prop("checked")||$("#ccm-"+a+"-add-to-set-form input[name=fsNewText]").val("")}),$("#ccm-"+a+"-add-to-set-form").submit(function(){return ccm_alSubmitSetsForm(a),!1})},ccm_alSetupPasswordForm=function(){$("#ccm-file-password-form").submit(function(){return ccm_alSubmitPasswordForm(),!1})},ccm_alRescanFiles=function(){var a=CCM_TOOLS_PATH+"/files/rescan?",b=arguments;for(i=0;i<b.length;i++)a+="fID[]="+b[i]+"&";$.fn.dialog.open({title:ccmi18n_filemanager.rescan,href:a,width:350,modal:!1,height:200,onClose:function(){1==b.length&&($("#ccm-file-properties-wrapper").html(""),jQuery.fn.dialog.showLoader(),$("#ccm-file-properties-wrapper").load(CCM_TOOLS_PATH+"/files/properties?fID="+b[0]+"&reload=1",!1,function(){jQuery.fn.dialog.hideLoader(),$(this).find(".dialog-launch").dialog()}))}})},ccm_alSelectPermissionsEntity=function(a,b,c){var d=$("#ccm-file-permissions-entity-base").html();$("#ccm-file-permissions-entities-wrapper").append('<div class="ccm-file-permissions-entity">'+d+"</div>");var e=$(".ccm-file-permissions-entity"),f=e[e.length-1];$(f).find("h3 span").html(c),$(f).find("input[type=hidden]").val(a+"_"+b),$(f).find("select").each(function(){$(this).attr("name",$(this).attr("name")+"_"+a+"_"+b)}),$(f).find("div.ccm-file-access-extensions input[type=checkbox]").each(function(){$(this).attr("name",$(this).attr("name")+"_"+a+"_"+b+"[]")}),ccm_alActivateFilePermissionsSelector()},ccm_alActivateFilePermissionsSelector=function(){$(".ccm-file-access-add select").unbind(),$(".ccm-file-access-add select").change(function(){var a=$(this).parents("div.ccm-file-permissions-entity")[0];$(this).val()==ccmi18n_filemanager.PTYPE_CUSTOM?$(a).find("div.ccm-file-access-add-extensions").show():$(a).find("div.ccm-file-access-add-extensions").hide()}),$(".ccm-file-access-file-manager select").change(function(){var a=$(this).parents("div.ccm-file-permissions-entity")[0];$(this).val()!=ccmi18n_filemanager.PTYPE_NONE?($(a).find(".ccm-file-access-add").show(),$(a).find(".ccm-file-access-edit").show(),$(a).find(".ccm-file-access-admin").show()):($(a).find(".ccm-file-access-add").hide(),$(a).find(".ccm-file-access-edit").hide(),$(a).find(".ccm-file-access-admin").hide(),$(a).find("div.ccm-file-access-add-extensions").hide())}),$("a.ccm-file-permissions-remove").click(function(){$(this).parent().parent().fadeOut(100,function(){$(this).remove()})}),$("input[name=toggleCanAddExtension]").unbind(),$("input[name=toggleCanAddExtension]").click(function(){var a=$(this).parent().parent().find("div.ccm-file-access-extensions");1==$(this).prop("checked")?a.find("input").attr("checked",!0):a.find("input").attr("checked",!1)})},ccm_alSetupVersionSelector=function(){$("#ccm-file-versions-grid input[type=radio]").click(function(){$("#ccm-file-versions-grid tr").removeClass("ccm-file-versions-grid-active");var a=$(this).parent().parent(),b=a.attr("fID"),c=a.attr("fvID"),d="task=approve_version&fID="+b+"&fvID="+c;$.post(CCM_TOOLS_PATH+"/files/properties",d,function(){a.addClass("ccm-file-versions-grid-active"),a.find("td").show("highlight",{color:"#FFF9BB"})})}),$(".ccm-file-versions-remove").click(function(){var a=$(this).parent().parent(),b=a.attr("fID"),c=a.attr("fvID"),d="task=delete_version&fID="+b+"&fvID="+c;return $.post(CCM_TOOLS_PATH+"/files/properties",d,function(){a.fadeOut(200,function(){a.remove()})}),!1})},ccm_alDeleteFiles=function(a){$("#ccm-"+a+"-delete-form").ajaxSubmit(function(b){ccm_parseJSON(b,function(){jQuery.fn.dialog.closeTop(),ccm_deactivateSearchResults(a),$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(b){ccm_parseAdvancedSearchResponse(b,a)})})})},ccm_alDuplicateFiles=function(searchInstance){$("#ccm-"+searchInstance+"-duplicate-form").ajaxSubmit(function(resp){ccm_parseJSON(resp,function(){jQuery.fn.dialog.closeTop(),ccm_deactivateSearchResults(searchInstance);var r=eval("("+resp+")");$("#ccm-"+searchInstance+"-advanced-search").ajaxSubmit(function(a){ccm_parseAdvancedSearchResponse(a,searchInstance);var b=new Array;for(i=0;i<r.fID.length;i++)fID=r.fID[i],ccm_uploadedFiles.push(fID),b.push(fID);ccm_alRefresh(b,searchInstance),ccm_filesUploadedDialog(searchInstance)})})})},ccm_alSetupSelectFiles=function(a){$(".ccm-file-list").unbind(),$(".ccm-file-list tr.ccm-list-record").click(function(a){a.stopPropagation(),ccm_alActivateMenu($(this),a)}),$(".ccm-file-list img.ccm-star").click(function(a){a.stopPropagation();var b=$(a.target).parents("tr.ccm-list-record")[0].id;b=b.substring(3),ccm_starFile(a.target,b)}),"DASHBOARD"==ccm_alLaunchType[a]&&$(".ccm-file-list-thumbnail").hover(function(){var a=$(this).attr("fID"),b=$("#fID"+a+"hoverThumbnail");if(b.length>0){var c=b.find("div"),d=b.position();c.css("top",d.top),c.css("left",d.left),c.show()}},function(){var a=$(this).attr("fID"),b=$("#fID"+a+"hoverThumbnail"),c=b.find("div");c.hide()})},ccm_alSetupCheckboxes=function(a){if($("#ccm-"+a+"-list-cb-all").unbind(),$("#ccm-"+a+"-list-cb-all").click(function(){ccm_hideMenus(),1==$(this).prop("checked")?($("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]").attr("checked",!0),$("#ccm-"+a+"-list-multiple-operations").attr("disabled",!1)):($("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]").attr("checked",!1),$("#ccm-"+a+"-list-multiple-operations").attr("disabled",!0))}),$("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]").click(function(b){b.stopPropagation(),ccm_hideMenus(),ccm_alRescanMultiFileMenu(a)}),$("#ccm-"+a+"-search-results td.ccm-file-list-cb").click(function(b){b.stopPropagation(),ccm_hideMenus(),$(this).find("input[type=checkbox]").click(),ccm_alRescanMultiFileMenu(a)}),"DASHBOARD"!=ccm_alLaunchType[a]&&"BROWSE"!=ccm_alLaunchType[a]){var b=ccmi18n_filemanager.select;$("#ccm-"+a+"-list-multiple-operations option:eq(0)").after('<option value="choose">'+b+"</option>")}$("#ccm-"+a+"-list-multiple-operations").change(function(){var b=$(this).val(),c=ccm_alGetSelectedFileIDs(a);switch(b){case"choose":var d=new Array;$("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").each(function(){d.push($(this).val())}),ccm_alSelectFile(d,!0);break;case"delete":jQuery.fn.dialog.open({width:500,height:400,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/files/delete?"+c+"&searchInstance="+a,title:ccmi18n_filemanager.deleteFile});break;case"duplicate":jQuery.fn.dialog.open({width:500,height:400,modal:!1,href:CCM_TOOLS_PATH+"/files/duplicate?"+c+"&searchInstance="+a,title:ccmi18n_filemanager.duplicateFile});break;case"sets":jQuery.fn.dialog.open({width:500,height:400,modal:!1,href:CCM_TOOLS_PATH+"/files/add_to?"+c+"&searchInstance="+a,title:ccmi18n_filemanager.sets});break;case"properties":jQuery.fn.dialog.open({width:690,height:440,modal:!1,href:CCM_TOOLS_PATH+"/files/bulk_properties?"+c+"&searchInstance="+a,title:ccmi18n.properties});break;case"rescan":jQuery.fn.dialog.open({width:350,height:200,modal:!1,href:CCM_TOOLS_PATH+"/files/rescan?"+c+"&searchInstance="+a,title:ccmi18n_filemanager.rescan,onClose:function(){$("#ccm-"+a+"-advanced-search").submit()}});break;case"download":window.frames[ccm_alProcessorTarget].location=CCM_TOOLS_PATH+"/files/download?"+c}$(this).get(0).selectedIndex=0}),ccm_alSetupFileSetSearch(a)},ccm_alSetupFileSetSearch=function(a){$("#ccm-"+a+"-sets-search-wrapper select").chosen().unbind(),$("#ccm-"+a+"-sets-search-wrapper select").chosen().change(function(){$("#ccm-"+a+"-sets-search-wrapper option:selected");$("#ccm-"+a+"-advanced-search").submit()})},ccm_alGetSelectedFileIDs=function(a){var b="";return $("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").each(function(){b+="fID[]="+$(this).val()+"&"}),b},ccm_alRescanMultiFileMenu=function(a){$("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").length>0?$("#ccm-"+a+"-list-multiple-operations").attr("disabled",!1):$("#ccm-"+a+"-list-multiple-operations").attr("disabled",!0)},ccm_alSetupFileProcessor=function(){if(""!=ccm_alProcessorTarget)return!1;var a,b=parseInt((new Date).getTime().toString().substring(0,10));try{a=document.createElement('<iframe name="ccm-al-upload-processor'+b+'">')}catch(c){a=document.createElement("iframe")}a.id="ccm-al-upload-processor"+b,a.name="ccm-al-upload-processor"+b,a.style.border="0px",a.style.width="0px",a.style.height="0px",a.style.display="none",document.body.appendChild(a),ccm_alProcessorTarget=ccm_alDebug?"_blank":"ccm-al-upload-processor"+b},ccm_alSubmitSingle=function(a){return""==$(a).find(".ccm-al-upload-single-file").val()?!1:($(a).find(".ccm-al-upload-single-submit").hide(),$(a).find(".ccm-al-upload-single-loader").show(),void 0)},ccm_alResetSingle=function(){$(".ccm-al-upload-single-file").val(""),$(".ccm-al-upload-single-loader").hide(),$(".ccm-al-upload-single-submit").show()};var ccm_uploadedFiles=[];ccm_filesUploadedDialog=function(a){document.getElementById("ccm-file-upload-multiple-tab")&&jQuery.fn.dialog.closeTop();for(var b="",c=0;c<ccm_uploadedFiles.length;c++)b=b+"&fID[]="+ccm_uploadedFiles[c];jQuery.fn.dialog.open({width:690,height:440,modal:!1,href:CCM_TOOLS_PATH+"/files/bulk_properties/?"+b+"&uploaded=true&searchInstance="+a,onClose:function(){ccm_deactivateSearchResults(a),$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(b){ccm_parseAdvancedSearchResponse(b,a)})},title:ccmi18n_filemanager.uploadComplete}),ccm_uploadedFiles=[]},ccm_alSetupUploadDetailsForm=function(a){$("#ccm-"+a+"-update-uploaded-details-form").submit(function(){return ccm_alSubmitUploadDetailsForm(a),!1})},ccm_alSubmitUploadDetailsForm=function(searchInstance){jQuery.fn.dialog.showLoader(),$("#ccm-"+searchInstance+"-update-uploaded-details-form").ajaxSubmit(function(r1){var r1a=eval("("+r1+")"),form=$("#ccm-"+searchInstance+"-advanced-search");form.length>0?form.ajaxSubmit(function(a){$("#ccm-"+searchInstance+"-sets-search-wrapper").load(CCM_TOOLS_PATH+"/files/search_sets_reload",{searchInstance:searchInstance},function(){jQuery.fn.dialog.hideLoader(),jQuery.fn.dialog.closeTop(),ccm_parseAdvancedSearchResponse(a,searchInstance),ccm_alHighlightFileIDArray(r1a)})}):(jQuery.fn.dialog.hideLoader(),jQuery.fn.dialog.closeTop())})},ccm_alRefresh=function(a,b,c){var d=a;ccm_deactivateSearchResults(b),$("#ccm-"+b+"-search-results").load(CCM_TOOLS_PATH+"/files/search_results",{ccm_order_by:"fvDateAdded",ccm_order_dir:"desc",fileSelector:c,searchType:ccm_alLaunchType[b],searchInstance:b},function(){ccm_activateSearchResults(b),0!=d&&ccm_alHighlightFileIDArray(d),ccm_alSetupSelectFiles(b)})},ccm_alHighlightFileIDArray=function(a){for(i=0;i<a.length;i++){var b=$("tr[fID="+a[i]+"] td"),c=b.css("backgroundColor");b.animate({backgroundColor:"#FFF9BB"},{queue:!0,duration:1e3}).animate({backgroundColor:c},500)}},ccm_alSelectFile=function(a){if("function"==typeof ccm_chooseAsset){var b="";if("object"==typeof a)for(i=0;i<a.length;i++)b+="fID[]="+a[i]+"&";else b+="fID="+a;$.getJSON(CCM_TOOLS_PATH+"/files/get_data.php?"+b,function(a){ccm_parseJSON(a,function(){for(i=0;i<a.length;i++)ccm_chooseAsset(a[i]);jQuery.fn.dialog.closeTop()})})}else{if("object"==typeof a)for(i=0;i<a.length;i++)ccm_triggerSelectFile(a[i]);else ccm_triggerSelectFile(a);jQuery.fn.dialog.closeTop()}},ccm_alActivateMenu=function(a,b){var c=$(a).find("div[ccm-file-manager-field]"),d="";c.length>0&&(d=c.attr("ccm-file-manager-field")),d||(d=ccm_alActiveAssetField),ccm_hideMenus();var e=$(a).attr("fID"),f=$(a).attr("ccm-file-manager-instance"),g=document.getElementById("ccm-al-menu"+e+f+d);if(g)g=$("#ccm-al-menu"+e+f+d);else{el=document.createElement("DIV"),el.id="ccm-al-menu"+e+f+d,el.className="ccm-menu ccm-ui",el.style.display="block",el.style.visibility="hidden",document.body.appendChild(el);var h=$("div[ccm-file-manager-field="+d+"] input.ccm-file-manager-filter"),i="";h.length>0&&h.each(function(){i+="&"+$(this).attr("name")+"="+$(this).attr("value")});{$(a).attr("al-filepath")}g=$("#ccm-al-menu"+e+f+d),g.css("position","absolute");var j='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">';if(j+="<ul>","DASHBOARD"!=ccm_alLaunchType[f]&&"BROWSE"!=ccm_alLaunchType[f]){var k=c.length>0?"ccm_alLaunchSelectorFileManager('"+d+"')":"ccm_alSelectFile("+e+")",l=c.length>0?ccmi18n_filemanager.chooseNew:ccmi18n_filemanager.select;j+='<li><a class="ccm-menu-icon ccm-icon-choose-file-menu" dialog-modal="false" dialog-width="90%" dialog-height="70%" dialog-title="'+ccmi18n_filemanager.select+'" id="menuSelectFile'+e+'" href="javascript:void(0)" onclick="'+k+'">'+l+"</a></li>"}c.length>0&&(j+='<li><a class="ccm-menu-icon ccm-icon-clear-file-menu" href="javascript:void(0)" id="menuClearFile'+e+f+d+'">'+ccmi18n_filemanager.clear+"</a></li>"),"DASHBOARD"!=ccm_alLaunchType[f]&&"BROWSE"!=ccm_alLaunchType[f]&&c.length>0&&(j+='<li class="ccm-menu-separator"></li>'),j+="1"==$(a).attr("ccm-file-manager-can-view")?'<li><a class="ccm-menu-icon ccm-icon-view dialog-launch" dialog-modal="false" dialog-append-buttons="true" dialog-width="90%" dialog-height="75%" dialog-title="'+ccmi18n_filemanager.view+'" id="menuView'+e+'" href="'+CCM_TOOLS_PATH+"/files/view?fID="+e+'">'+ccmi18n_filemanager.view+"</a></li>":'<li><a class="ccm-menu-icon ccm-icon-download-menu" href="javascript:void(0)" id="menuDownload'+e+'" onclick="window.frames[\''+ccm_alProcessorTarget+"'].location='"+CCM_TOOLS_PATH+"/files/download?fID="+e+"'\">"+ccmi18n_filemanager.download+"</a></li>","1"==$(a).attr("ccm-file-manager-can-edit")&&(j+='<li><a class="ccm-menu-icon ccm-icon-edit-menu dialog-launch" dialog-modal="false" dialog-width="90%" dialog-height="75%" dialog-title="'+ccmi18n_filemanager.edit+'" id="menuEdit'+e+'" href="'+CCM_TOOLS_PATH+"/files/edit?searchInstance="+f+"&fID="+e+i+'">'+ccmi18n_filemanager.edit+"</a></li>"),j+='<li><a class="ccm-menu-icon ccm-icon-properties-menu dialog-launch" dialog-modal="false" dialog-width="680" dialog-height="450" dialog-title="'+ccmi18n_filemanager.properties+'" id="menuProperties'+e+'" href="'+CCM_TOOLS_PATH+"/files/properties?searchInstance="+f+"&fID="+e+'">'+ccmi18n_filemanager.properties+"</a></li>","1"==$(a).attr("ccm-file-manager-can-replace")&&(j+='<li><a class="ccm-menu-icon ccm-icon-replace dialog-launch" dialog-modal="false" dialog-width="300" dialog-height="260" dialog-title="'+ccmi18n_filemanager.replace+'" id="menuFileReplace'+e+'" href="'+CCM_TOOLS_PATH+"/files/replace?searchInstance="+f+"&fID="+e+'">'+ccmi18n_filemanager.replace+"</a></li>"),"1"==$(a).attr("ccm-file-manager-can-duplicate")&&(j+='<li><a class="ccm-menu-icon ccm-icon-copy-menu" id="menuFileDuplicate'+e+'" href="javascript:void(0)" onclick="ccm_alDuplicateFile('+e+",'"+f+"')\">"+ccmi18n_filemanager.duplicate+"</a></li>"),j+='<li><a class="ccm-menu-icon ccm-icon-sets dialog-launch" dialog-modal="false" dialog-width="500" dialog-height="400" dialog-title="'+ccmi18n_filemanager.sets+'" id="menuFileSets'+e+'" href="'+CCM_TOOLS_PATH+"/files/add_to?searchInstance="+f+"&fID="+e+'">'+ccmi18n_filemanager.sets+"</a></li>",("1"==$(a).attr("ccm-file-manager-can-admin")||"1"==$(a).attr("ccm-file-manager-can-delete"))&&(j+='<li class="ccm-menu-separator"></li>'),"1"==$(a).attr("ccm-file-manager-can-admin")&&(j+='<li><a class="ccm-menu-icon ccm-icon-access-permissions dialog-launch" dialog-modal="false" dialog-width="400" dialog-height="450" dialog-title="'+ccmi18n_filemanager.permissions+'" id="menuFilePermissions'+e+'" href="'+CCM_TOOLS_PATH+"/files/permissions?searchInstance="+f+"&fID="+e+'">'+ccmi18n_filemanager.permissions+"</a></li>"),"1"==$(a).attr("ccm-file-manager-can-delete")&&(j+='<li><a class="ccm-icon-delete-menu ccm-menu-icon dialog-launch" dialog-append-buttons="true" dialog-modal="false" dialog-width="500" dialog-height="200" dialog-title="'+ccmi18n_filemanager.deleteFile+'" id="menuDeleteFile'+e+'" href="'+CCM_TOOLS_PATH+"/files/delete?searchInstance="+f+"&fID="+e+'">'+ccmi18n_filemanager.deleteFile+"</a></li>"),j+="</ul>",j+="</div></div></div>",g.append(j),$(g).find("a").bind("click.hide-menu",function(){return ccm_hideMenus(),!1}),$("#ccm-al-menu"+e+f+d+" a.dialog-launch").dialog(),$("a#menuClearFile"+e+f+d).click(function(a){ccm_clearFile(a,d),ccm_hideMenus()})}ccm_fadeInMenu(g,b)},ccm_alSelectNone=function(){ccm_hideMenus()};var checkbox_status=!1;toggleCheckboxStatus=function(a){if(checkbox_status){for(i=0;i<a.elements.length;i++)"checkbox"==a.elements[i].type&&(a.elements[i].checked=!1);checkbox_status=!1}else{for(i=0;i<a.elements.length;i++)"checkbox"==a.elements[i].type&&(a.elements[i].checked=!0);checkbox_status=!0}},ccm_alDuplicateFile=function(fID,searchInstance){var postStr="fID="+fID+"&searchInstance="+searchInstance;$.post(CCM_TOOLS_PATH+"/files/duplicate",postStr,function(resp){var r=eval("("+resp+")");if(1==r.error)return ccmAlert.notice(ccmi18n.error,r.message),!1;var highlight=new Array;r.fID&&(highlight.push(r.fID),ccm_alRefresh(highlight,searchInstance),ccm_uploadedFiles.push(r.fID),ccm_filesUploadedDialog(searchInstance))})},ccm_alSelectMultipleIncomingFiles=function(a){$(a).prop("checked")?$("input.ccm-file-select-incoming").attr("checked",!0):$("input.ccm-file-select-incoming").attr("checked",!1)},ccm_starFile=function(a,b){var c="";-1!=$(a).attr("src").indexOf(CCM_STAR_STATES.unstarred)?($(a).attr("src",$(a).attr("src").replace(CCM_STAR_STATES.unstarred,CCM_STAR_STATES.starred)),c="star"):($(a).attr("src",$(a).attr("src").replace(CCM_STAR_STATES.starred,CCM_STAR_STATES.unstarred)),c="unstar"),$.post(CCM_TOOLS_PATH+"/"+CCM_STAR_ACTION,{action:c,"file-id":b},function(){})},jQuery.cookie=function(a,b,c){if("undefined"==typeof b){var d=null;if(document.cookie&&""!=document.cookie)for(var e=document.cookie.split(";"),f=0;f<e.length;f++){var g=jQuery.trim(e[f]);if(g.substring(0,a.length+1)==a+"="){d=decodeURIComponent(g.substring(a.length+1));break}}return d}c=c||{},null===b&&(b="",c=$.extend({},c),c.expires=-1);var h="";if(c.expires&&("number"==typeof c.expires||c.expires.toUTCString)){var i;"number"==typeof c.expires?(i=new Date,i.setTime(i.getTime()+24*c.expires*60*60*1e3)):i=c.expires,h="; expires="+i.toUTCString()}var j=c.path?"; path="+c.path:"",k=c.domain?"; domain="+c.domain:"",l=c.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(b),h,j,k,l].join("")};var CCMPanel=function(a){this.options=a,this.isOpen=!1,this.detail=!1,this.getPositionClass=function(){switch(a.position){case"left":var b="ccm-panel-left";break;case"right":var b="ccm-panel-right"}switch(a.transition){case"slide":b+=" ccm-panel-transition-slide";break;default:b+=" ccm-panel-transition-none"}return b},this.getURL=function(){return this.options.url},this.getIdentifier=function(){return this.options.identifier},this.getDOMID=function(){return"ccm-panel-"+this.options.identifier.replace("/","-")},this.onPanelLoad=function(){this.setupPanelDetails(),this.setupSubPanels(),ccm_event.publish("panel.open",this)},this.hide=function(){var a=this.closePanelDetail();a||(a=0);var b=this;$(window).delay(a).queue(function(){$("[data-launch-panel='"+b.getIdentifier()+"']").removeClass("ccm-launch-panel-active"),$("#"+b.getDOMID()).removeClass("ccm-panel-active"),$("#ccm-panel-overlay").queue(function(){$(this).removeClass("ccm-panel-translucent"),$(this).dequeue()}).delay(1e3).hide(0),$("html").removeClass(b.getPositionClass()),b.isOpen=!1,$(this).dequeue()})},this.toggle=function(){this.isOpen?this.hide():this.show()},this.setupSubPanels=function(){var a=$("#"+this.getDOMID()),b=this;a.find("[data-launch-sub-panel-url]").unbind(".sub").on("click.sub",function(){var c=$(this).attr("data-launch-sub-panel-url");return $("<div />",{"class":"ccm-panel-content ccm-panel-content-appearing"}).appendTo(a.find(".ccm-panel-content-wrapper")).load(c+"?cID="+CCM_CID,function(){a.find(".ccm-panel-content-visible").removeClass("ccm-panel-content-visible").addClass("ccm-panel-slide-left"),$(this).removeClass("ccm-panel-content-appearing").addClass("ccm-panel-content-visible"),b.onPanelLoad()}),$(this).removeClass("ccm-panel-menu-item-active"),!1}),a.find("[data-panel-navigation=back]").on("click.navigate",function(){return b.closePanelDetailImmediately(),$(this).queue(function(){var b=a.find(".ccm-panel-content-visible").prev();a.find(".ccm-panel-content-visible").removeClass("ccm-panel-content-visible").addClass("ccm-panel-slide-right"),b.removeClass("ccm-panel-slide-left").addClass("ccm-panel-content-visible"),$(this).dequeue()}).delay(500).queue(function(){a.find(".ccm-panel-slide-right").remove(),$(this).dequeue()}),!1})},this.showPanelConfirmationMessage=function(a,b,c){var d='<div id="ccm-panel-confirmation-'+a+'" class="ccm-ui ccm-panel-confirmation-wrapper"><div class="ccm-panel-confirmation">';d+="<p>"+b+'</p><div class="ccm-panel-confirmation-buttons"></div>',d+="</div></div>",$(d).appendTo(document.body);var e=$("#ccm-panel-confirmation-"+a);e.delay(0).queue(function(){$(this).addClass("ccm-panel-confirmation-displayed"),$(this).dequeue()});var f=[{"class":"btn pull-left btn-link",type:"button","data-panel-confirmation-action":"cancel",text:ccmi18n.cancel}];for(i=0;i<c.length;i++)f.push(c[i]);$.each(f,function(a,b){e.find(".ccm-panel-confirmation-buttons").append($("<button />",b))}),e.find("button").on("click",function(){e.delay(0).queue(function(){e.removeClass("ccm-panel-confirmation-displayed"),e.addClass("ccm-panel-confirmation-disappearing"),$(this).dequeue()}).delay(350).queue(function(){e.remove()})})},this.closePanelDetail=function(){if(!this.detail)return!1;$("a[data-launch-panel-detail="+this.detail.identifier+"]").removeClass("ccm-panel-menu-item-active");var a=this.detail.transition;return $("div.ccm-panel-detail").queue(function(){$(this).removeClass("ccm-panel-detail-transition-"+a+"-apply"),$(this).dequeue()}).delay(550).queue(function(){$(this).remove(),$(this).dequeue()}),$("div.ccm-page").queue(function(){$(this).removeClass("ccm-panel-detail-transition-"+a+"-apply"),$(this).dequeue()}).delay(550).queue(function(){$("html").removeClass("ccm-panel-detail-open"),$(this).addClass("ccm-panel-detail-disable-transition"),$(this).dequeue()}).delay(1).queue(function(){$(this).removeClass("ccm-panel-detail-transition-"+a),$(this).dequeue()}).delay(1).queue(function(){$(this).removeClass("ccm-panel-detail-disable-transition"),$(this).dequeue()}),$("#ccm-panel-detail-form-actions-wrapper .ccm-panel-detail-form-actions").queue(function(){$(this).css("opacity",0),$(this).dequeue(0)}).delay(550).queue(function(){$(this).remove(),$(this).dequeue()}),ccm_event.publish("panel.closeDetail",this.detail),this.detail=!1,$(".ccm-panel-detail").length>0?550:void 0},this.closePanelDetailImmediately=function(){return this.detail?($(".ccm-panel-detail").remove(),$(".ccm-panel-detail-form-actions").remove(),$(".ccm-page").removeClass().addClass("ccm-page"),ccm_event.publish("panel.closeDetail",this.detail),this.detail=!1,void 0):!1},this.openPanelDetail=function(a){var b=this,a=$.extend({transition:"none",url:!1,data:""},a),c=a.identifier;b.detail,b.detail&&b.closePanelDetailImmediately(),b.detail=a;var d="ccm-panel-detail-"+c;$detail=$("<div />",{id:d,"class":"ccm-panel-detail"}).appendTo(document.body),$content=$("<div />",{"class":"ccm-panel-detail-content"}).appendTo($detail),$("div.ccm-page").queue(function(){$detail.addClass("ccm-panel-detail-transition-"+a.transition),$(this).addClass("ccm-panel-detail-transition-"+a.transition),$(this).dequeue()}).delay(3).queue(function(){$detail.addClass("ccm-panel-detail-transition-"+a.transition+"-apply"),$(this).addClass("ccm-panel-detail-transition-"+a.transition+"-apply"),$(this).dequeue()}),$("html").addClass("ccm-panel-detail-open"),$content.load(a.url+"?cID="+CCM_CID+a.data,function(){jQuery.fn.dialog.hideLoader(),$content.find(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"}),b.loadPanelDetailActions($content)}),ccm_event.publish("panel.openDetail",b)},this.loadPanelDetailActions=function(a){var b=this,c=a.find(".ccm-panel-detail-form-actions");c.length&&($(document.body).delay(500).queue(function(){var a=$("#ccm-panel-detail-form-actions-wrapper");a.length||(a=$("<div />",{id:"ccm-panel-detail-form-actions-wrapper","class":"ccm-ui"})),a.appendTo(document.body),c.appendTo(a),$(this).dequeue()}).delay(5).queue(function(){$("#ccm-panel-detail-form-actions-wrapper .ccm-panel-detail-form-actions").css("opacity",1),$(this).dequeue()}),$("button[data-panel-detail-action=cancel]").on("click",function(){b.closePanelDetail()}),$("button[data-panel-detail-action=submit]").on("click",function(){CCMEditMode.setupAjaxForm($("[data-panel-detail-form]")).submit()}))},this.setupPanelDetails=function(){var a=$("#"+this.getDOMID()),b=this;a.find(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"}),a.find("[data-panel-menu=accordion]").each(function(){var c=$(this),d=$(this).find(">nav>span");d.text($(this).find("a[data-panel-accordion-tab-selected=true]").text()),d.unbind(".accordion").on("click.accordion",function(){c.toggleClass("ccm-panel-header-accordion-dropdown-visible")}),$(this).find(">nav ul a").unbind(".accordion").on("click.accordion",function(){var e=b.getURL(),f=a.find(".ccm-panel-content");
c.removeClass("ccm-panel-header-accordion-dropdown-visible"),d.html($(this).text()),f.load(e+"?cID="+CCM_CID+"&tab="+$(this).attr("data-panel-accordion-tab"),function(){b.onPanelLoad()})})}),a.find(".dialog-launch").dialog(),a.find("[data-panel-menu=collapsible-list-group]").each(function(){var a=$(this);a.find(".list-group-item-collapse").unbind(".clg").on("click.clg",function(){var b=a.find(".list-group-item-collapse-wrapper"),c=a.attr("data-panel-menu-id"),d=a.find(".list-group-item-collapse span"),e=b.height();a.hasClass("ccm-panel-list-group-item-expanded")?(d.text(ccmi18n.expand),ccm_event.publish("collapse."+c),b.queue(function(){$(this).css("height",0),$(this).dequeue()}).delay(305).queue(function(){$(this).hide(),$(this).css("height","auto"),$(this).dequeue()})):(ccm_event.publish("expand."+c),d.text(ccmi18n.collapse),b.queue(function(){$(this).css("height",0),$(this).show(),$(this).dequeue()}).delay(5).queue(function(){$(this).css("height",e),$(this).dequeue()})),a.toggleClass("ccm-panel-list-group-item-expanded")})}),a.find("[data-launch-panel-detail]").unbind(".detail").on("click.detail",function(){jQuery.fn.dialog.showLoader(),$(".ccm-panel-menu-item-active").removeClass("ccm-panel-menu-item-active"),$(this).addClass("ccm-panel-menu-item-active");var a=$(this).attr("data-launch-panel-detail"),c={identifier:a};return $(this).attr("data-panel-transition")&&(c.transition=$(this).attr("data-panel-transition")),$(this).attr("data-panel-detail-url")&&(c.url=$(this).attr("data-panel-detail-url")),b.openPanelDetail(c),!1}),b.loadPanelDetailActions(a)},this.show=function(){var a=0;if(this.options.primary){var b=CCMPanelManager.getPanels();for(i=0;i<b.length;i++){var c=b[i];c.getIdentifier()!=this.getIdentifier()&&c.isOpen&&(a=c.hide())}}obj=this,$(window).delay(a).queue(function(){var a=$("#"+obj.getDOMID());a.find(".ccm-panel-content-wrapper").html(""),a.addClass("ccm-panel-active ccm-panel-loading"),$("<div />",{"class":"ccm-panel-content ccm-panel-content-visible"}).appendTo(a.find(".ccm-panel-content-wrapper")).load(obj.getURL()+"?cID="+CCM_CID,function(){a.delay(1).queue(function(){$(this).removeClass("ccm-panel-loading").addClass("ccm-panel-loaded"),$(this).dequeue()}),obj.onPanelLoad()}),CCMPanelManager.showOverlay(obj.options.translucent),$("[data-launch-panel='"+obj.getIdentifier()+"']").addClass("ccm-launch-panel-active"),$("html").addClass(obj.getPositionClass()),obj.isOpen=!0,$(this).dequeue()})}},CCMPanelManager=function(){var a=new Array;return{getPanels:function(){return a},showOverlay:function(a){$("#ccm-panel-overlay").clearQueue().show(0).delay(100).queue(function(){a?$(this).addClass("ccm-panel-translucent"):$(this).removeClass("ccm-panel-translucent"),$(this).dequeue()})},exitPanelMode:function(){for(i=0;i<a.length;i++)a[i].isOpen&&a[i].hide();CCMEditMode.exitPreviewMode()},register:function(b){var b=$.extend({translucent:!0,position:"left",primary:!0,transition:"slide"},b),c=new CCMPanel(b);a.push(c),$("<div />",{id:c.getDOMID(),"class":"ccm-panel "+c.getPositionClass()}).appendTo($(document.body)),$stage=$("<div />",{"class":"ccm-panel-content-wrapper ccm-ui"}).appendTo($("#"+c.getDOMID())),$("<div />",{"class":"ccm-panel-shadow-layer"}).appendTo($("#"+c.getDOMID()))},getByIdentifier:function(b){for(i=0;i<a.length;i++)if(a[i].getIdentifier()==b)return a[i]}}}();$.widget.bridge("jqdialog",$.ui.dialog),jQuery.fn.dialog=function(){return arguments.length>0?($(this).jqdialog(arguments[0],arguments[1],arguments[2]),void 0):$(this).is("div")?($(this).jqdialog(),void 0):$(this).each(function(){$(this).unbind("click.make-dialog").bind("click.make-dialog",function(){var a=$(this).attr("href"),b=$(this).attr("dialog-width"),c=$(this).attr("dialog-height"),d=$(this).attr("dialog-title"),e=$(this).attr("dialog-on-open"),f=$(this).attr("dialog-on-destroy"),g=$(this).attr("dialog-on-close"),h=$(this).attr("dialog-on-direct-close");return obj={modal:!0,href:a,width:b,height:c,title:d,onOpen:e,onDestroy:f,onClose:g,onDirectClose:h},jQuery.fn.dialog.open(obj),!1})})},jQuery.fn.dialog.close=function(a){a++,$("#ccm-dialog-content"+a).jqdialog("close")},jQuery.fn.dialog.open=function(options){"undefined"!=typeof $.fn.ccmmenu&&$.fn.ccmmenu.hide(),"string"==typeof options.width?"auto"==options.width?w="auto":options.width.indexOf("%",0)>0?(w=options.width.replace("%",""),w=$(window).width()*(w/100),w+=50):w=parseInt(options.width)+50:w=options.width?parseInt(options.width)+50:550,"string"==typeof options.height?"auto"==options.height?h="auto":options.height.indexOf("%",0)>0?(h=options.height.replace("%",""),h=$(window).height()*(h/100),h+=100):h=parseInt(options.height)+100:h=options.height?parseInt(options.height)+100:400,"auto"!==h&&h>$(window).height()&&(h=$(window).height()),options.width=w,options.height=h;var defaults={modal:!0,escapeClose:!0,width:w,height:h,create:function(){$(this).parent().addClass("ccm-dialog-opening")},open:function(){var $dialog=$(this);$dialog.parent().addClass("ccm-dialog-open");var nd=$(".ui-dialog").length;1==nd&&($("body").attr("data-last-overflow",$("body").css("overflow")),$("body").css("overflow","hidden"));var overlays=$(".ui-widget-overlay").length;$(".ui-widget-overlay").each(function(a){overlays>a+1&&$(this).css("opacity",0)}),jQuery.fn.dialog.activateDialogContents($dialog),"undefined"!=typeof options.onOpen&&("function"==typeof options.onOpen?options.onOpen($dialog):eval(options.onOpen))},beforeClose:function(){var a=$(".ui-dialog").length;1==a&&$("body").css("overflow",$("body").attr("data-last-overflow"))},close:function(ev,u){options.element||$(this).jqdialog("destroy").remove(),"undefined"!=typeof options.onClose&&("function"==typeof options.onClose?options.onClose():eval(options.onClose)),"undefined"==typeof options.onDirectClose||!ev.handleObj||"keydown"!=ev.handleObj.type&&"click"!=ev.handleObj.type||("function"==typeof options.onDirectClose?options.onDirectClose():eval(options.onDirectClose)),"undefined"!=typeof options.onDestroy&&("function"==typeof options.onDestroy?options.onDestroy():eval(options.onDestroy));var overlays=$(".ui-widget-overlay").length;$(".ui-widget-overlay").each(function(a){overlays>a+1?$(this).css("opacity",0):$(this).css("opacity",1)})}},finalSettings={autoOpen:!1};$.extend(finalSettings,defaults,options),finalSettings.element?($(finalSettings.element).jqdialog(finalSettings).jqdialog(),$(finalSettings.element).jqdialog("open")):(jQuery.fn.dialog.showLoader(),$.ajax({type:"GET",url:finalSettings.href,success:function(a){jQuery.fn.dialog.hideLoader(),$("<div />").jqdialog(finalSettings).html(a).jqdialog("open")}}))},jQuery.fn.dialog.activateDialogContents=function(a){if(a.find("button[data-dialog-action=cancel]").on("click",function(){jQuery.fn.dialog.closeTop()}),a.find("button[data-dialog-action=submit]").on("click",function(){CCMEditMode.setupAjaxForm($("[data-dialog-form]")).submit()}),a.find(".dialog-buttons").length>0&&(a.jqdialog("option","buttons",[{}]),a.parent().find(".ui-dialog-buttonset").remove(),a.parent().find(".ui-dialog-buttonpane").html(""),a.find(".dialog-buttons").appendTo(a.parent().find(".ui-dialog-buttonpane").addClass("ccm-ui"))),a.find(".dialog-launch").dialog(),a.find(".ccm-dialog-close").on("click",function(){a.dialog("close")}),a.find(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"}),a.find(".dialog-help").length>0){a.find(".dialog-help").hide();var b=a.find(".dialog-help").html();if(ccmi18n.helpPopup){ccmi18n.helpPopup}else;a.parent().find(".ui-dialog-titlebar").addClass("ccm-ui").append('<button class="ui-dialog-titlebar-help ccm-menu-help-trigger"><i class="glyphicon glyphicon-info-sign"></i></button>'),a.parent().find(".ui-dialog-titlebar .ccm-menu-help-trigger").popover({content:function(){return b},placement:"bottom",html:!0,container:"#ccm-tooltip-holder",trigger:"click"})}},jQuery.fn.dialog.getTop=function(){var a=$(".ui-dialog:visible").length;return $($(".ui-dialog:visible")[a-1]).find(".ui-dialog-content")},jQuery.fn.dialog.replaceTop=function(a){$dialog=jQuery.fn.dialog.getTop(),$dialog.html(a),jQuery.fn.dialog.activateDialogContents($dialog)},jQuery.fn.dialog.showLoader=function(){$("body").addClass("ccm-loading")},jQuery.fn.dialog.hideLoader=function(){$("body").removeClass("ccm-loading")},jQuery.fn.dialog.closeTop=function(){$dialog=jQuery.fn.dialog.getTop(),$dialog.jqdialog("close")},jQuery.fn.dialog.closeAll=function(){$($(".ui-dialog-content").get().reverse()).jqdialog("close")};var ccmAlert={notice:function(a,b,c){$('<div id="ccm-popup-alert" class="ccm-ui"><div id="ccm-popup-alert-message" class="alert alert-danger">'+b+"</div></div>").dialog({title:a,width:320,height:160,modal:!0,onDestroy:c})},hud:function(a,b,c,d){if(null==d)var e=a;else var e="<strong>"+d+"</strong><br/><br/>"+a;if(null==c)var c="pencil";var f="info";CCMEditMode.showResponseNotification(e,c,f)}};ccm_closeNewsflow=function(){$ovl=ccm_getNewsflowOverlayWindow(),$ovl.fadeOut(300,"easeOutExpo"),$(".ui-widget-overlay").fadeOut(300,"easeOutExpo",function(){$(this).remove()})},ccm_setNewsflowPagingArrowHeight=function(){if($("#ccm-marketplace-detail").length>0)var a=$("#ccm-marketplace-detail");else var a=$("#newsflow-main");var b=a.height();$(".newsflow-paging-previous a, .newsflow-paging-next a").css("height",b+"px"),$(".newsflow-paging-previous, .newsflow-paging-next").css("height",b+"px"),$(".newsflow-paging-next").show(),$(".newsflow-paging-previous").show()},ccm_setNewsflowOverlayDimensions=function(){if($("#newsflow-overlay").length>0){var a=$("#newsflow-overlay").width(),b=$(window).width(),c=$(window).height(),d=650,e=c-80;h=e>d?d:e,$("#newsflow-overlay").css("height",d);var f=(b-a)/2,g=(c-h)/2;g+=29,f+="px",g+="px",$("#newsflow-overlay").css("left",f).css("top",g)}},ccm_getNewsflowOverlayWindow=function(){if($("#ccm-dashboard-content").length>0&&$("#newsflow-main").length>0&&0==$("#newsflow-overlay").length)var a=$("#newsflow-main").parent();else if($("#newsflow-overlay").length>0)var a=$("#newsflow-overlay");else var a=$("<div />").attr("id","newsflow-overlay").attr("class","ccm-ui").css("display","none").appendTo(document.body);return a},ccm_showNewsflowOverlayWindow=function(a,b){if($("#ccm-dashboard-content").length>0&&$("#newsflow-main").length>0);else{if($(".ui-widget-overlay").length<1){$('<div class="ui-widget-overlay"></div>').hide().appendTo("body")}$(".ui-widget-overlay").show()}$(window).resize(function(){ccm_setNewsflowOverlayDimensions()}),$ovl=ccm_getNewsflowOverlayWindow(),$ovl.load(a,function(){$ovl.hide(),$(".newsflow-paging-next").hide(),$(".newsflow-paging-previous").hide(),$ovl.html($(this).html()),b&&b(),ccm_setNewsflowOverlayDimensions(),ccm_setupTrickleUpNewsflowStyles(),$ovl.fadeIn("300","easeOutExpo",function(){ccm_setNewsflowPagingArrowHeight()})})},ccm_setupTrickleUpNewsflowStyles=function(){ovl=ccm_getNewsflowOverlayWindow(),ovl.find(".newsflow-em1").each(function(){$(this).parent().addClass("newsflow-em1")})},ccm_showDashboardNewsflowWelcome=function(){jQuery.fn.dialog.showLoader(ccmi18n.newsflowLoading),ccm_showNewsflowOverlayWindow(CCM_DISPATCHER_FILENAME+"/dashboard/home?_ccm_dashboard_external=1",function(){jQuery.fn.dialog.hideLoader()})},ccm_showNewsflowOffsite=function(a){jQuery.fn.dialog.showLoader(),ccm_showNewsflowOverlayWindow(CCM_TOOLS_PATH+"/newsflow?cID="+a,function(){jQuery.fn.dialog.hideLoader()})},ccm_showAppIntroduction=function(){ccm_showNewsflowOverlayWindow(CCM_DISPATCHER_FILENAME+"/dashboard/welcome?_ccm_dashboard_external=1")},ccm_getNewsflowByPath=function(a){jQuery.fn.dialog.showLoader(),ccm_showNewsflowOverlayWindow(CCM_TOOLS_PATH+"/newsflow?cPath="+a,function(){jQuery.fn.dialog.hideLoader()})},ccm_doPageReindexing=function(){$.get(CCM_TOOLS_PATH+"/reindex_pending_pages?ccm_token="+CCM_SECURITY_TOKEN)},$.fn.ccmmenu=function(){return $.fn.ccmmenu.enable(),$.each($(this),function(a,b){var c,d=$(b);if(!d.prop("has-menu")){d.prop("has-menu",!0),c=d.attr("data-menu-handle")?$(d.attr("data-menu-handle")):d;var e=$("#"+d.attr("data-menu"));d.$menu=e,d.highlightClass=d.attr("data-menu-highlight-class"),d.highlightOffset=9,d.attr("data-menu-highlight-offset")&&(d.highlightOffset=d.attr("data-menu-highlight-offset")),d.menuClass=d.attr("data-menu-class"),c.on("mousemove.ccmmenu",function(a){$.fn.ccmmenu.over(a,d,$(this))})}})},$.fn.ccmmenu.resetHighlight=function(){$.fn.ccmmenu.$highlighter.hide(),$("[data-menu-highlight-class]").each(function(){var a=$(this).attr("data-menu-highlight-class");$("."+a).removeClass(a)})},$.fn.ccmmenu.highlight=function(a){var b=a.offset(),c=b.top-$.fn.ccmmenu.$overmenu.highlightOffset,d=b.left-$.fn.ccmmenu.$overmenu.highlightOffset,e=a.outerWidth()+2*$.fn.ccmmenu.$overmenu.highlightOffset,f=a.outerHeight()+2*$.fn.ccmmenu.$overmenu.highlightOffset;$.fn.ccmmenu.$highlighter.css("width",e).css("height",f).css("top",c).css("left",d).css("border-top-left-radius",a.css("border-top-left-radius")).css("border-bottom-left-radius",a.css("border-bottom-left-radius")).css("border-top-right-radius",a.css("border-top-right-radius")).css("border-bottom-right-radius",a.css("border-bottom-right-radius")).removeClass().addClass($.fn.ccmmenu.$overmenu.highlightClass),$.fn.ccmmenu.$highlighter.show()},$.fn.ccmmenu.out=function(){$.fn.ccmmenu.isactive||($.fn.ccmmenu.$proxy.css("opacity",0),$(".ccm-parent-menu-item-active").removeClass("ccm-parent-menu-item-active"),$(".ccm-menu-item-active").removeClass("ccm-menu-item-active"))},$.fn.ccmmenu.reset=function(){$.fn.ccmmenu.disable(),$.fn.ccmmenu.enable()},$.fn.ccmmenu.enable=function(){$.fn.ccmmenu.isenabled=!0,0==$("#ccm-menu-click-proxy").length?$(document.body).append($("<div />",{id:"ccm-menu-click-proxy"})):$("#ccm-menu-click-proxy").css("width",0).css("height",0).css("top",0).css("left",0),0==$("#ccm-menu-highlighter").length?$(document.body).append($("<div />",{id:"ccm-menu-highlighter"})):$("#ccm-menu-highlighter").css("width",0).css("height",0).css("top",0).css("left",0),0==$("#ccm-popover-menu-container").length&&$(document.body).append($("<div />",{id:"ccm-popover-menu-container","class":"ccm-ui"})),$.fn.ccmmenu.$proxy=$("#ccm-menu-click-proxy"),$.fn.ccmmenu.$highlighter=$("#ccm-menu-highlighter"),$.fn.ccmmenu.$holder=$("#ccm-popover-menu-container"),$.fn.ccmmenu.$proxy.on("mouseout.clickproxy",function(a){$.fn.ccmmenu.out(a)}),$.fn.ccmmenu.$proxy.on("mouseover.clickproxy",function(a){$.fn.ccmmenu.over(a)}),$.fn.ccmmenu.$proxy.unbind("click.clickproxy").on("click.clickproxy",function(a){$.fn.ccmmenu.$proxy.addClass($.fn.ccmmenu.$overmenu.menuClass),$.fn.ccmmenu.showmenu(a,$.fn.ccmmenu.$overmenu.$menu),$.fn.ccmmenu.highlight($.fn.ccmmenu.$overmenu),$.fn.ccmmenu.$overmenu.addClass($.fn.ccmmenu.$overmenu.highlightClass)})},$.fn.ccmmenu.disable=function(){$.fn.ccmmenu.out(),$.fn.ccmmenu.isenabled=!1,$.fn.ccmmenu.$proxy.remove(),$.fn.ccmmenu.resetHighlight()},$.fn.ccmmenu.over=function(a,b,c){if($.fn.ccmmenu.isenabled&&!$.fn.ccmmenu.isactive){if($(".ccm-menu-item-active").removeClass("ccm-menu-item-active"),$(".ccm-parent-menu-item-active").removeClass("ccm-parent-menu-item-active"),c){var d=c.offset(),e=d.top-5,f=d.left-5,g=c.outerWidth()+10,h=c.outerHeight()+10;$.fn.ccmmenu.$proxy.css("width",g).css("height",h).css("top",e).css("left",f).css("border-top-left-radius",c.css("border-top-left-radius")).css("border-bottom-left-radius",c.css("border-bottom-left-radius")).css("border-top-right-radius",c.css("border-top-right-radius")).css("border-bottom-right-radius",c.css("border-bottom-right-radius")).addClass(b.menuClass),$.fn.ccmmenu.$overmenu=b}$.fn.ccmmenu.$overmenu.addClass("ccm-menu-item-active"),$.fn.ccmmenu.$overmenu.parent().addClass("ccm-parent-menu-item-active")}},$.fn.ccmmenu.hide=function(a){a&&a.stopPropagation(),$.fn.ccmmenu.$proxy&&($.fn.ccmmenu.isactive=!1,$.fn.ccmmenu.$proxy.css("opacity",0),$.fn.ccmmenu.resetHighlight(),$.fn.ccmmenu.$holder.html(""),$(".ccm-menu-item-active").removeClass("ccm-menu-item-active"),$(".ccm-parent-menu-item-active").removeClass("ccm-parent-menu-item-active"),$(document).unbind("click.disableccmmenu"),$("div.popover").css("opacity",0).hide())},$.fn.ccmmenu.showmenu=function(a,b){a.stopPropagation(),$.fn.ccmmenu.isactive&&$("div.popover").css("opacity",0).hide(),$.fn.ccmmenu.isactive=!0;var c=b.clone(!0,!0);$.fn.ccmmenu.$overmenu&&c.addClass($.fn.ccmmenu.$overmenu.menuClass),c.appendTo($.fn.ccmmenu.$holder),c.find(".dialog-launch").dialog();var d=a.pageX+2,e=a.pageY+2;c.css("opacity",0).show();var f=c.height(),g=c.width();$(window).height()<a.clientY+f+30?(e=e-f-10,d-=g/2,c.removeClass("bottom"),c.addClass("top")):(d-=g/2,e+=10,c.removeClass("top"),c.addClass("bottom")),c.css("top",e+"px"),c.css("left",d+"px"),c.show().css("opacity",1),c.find("a").click(function(a){$.fn.ccmmenu.hide(a)}),$(document).on("click.disableccmmenu",function(a){$.fn.ccmmenu.hide(a)})},String.prototype.score=function(a,b){if(b=b||0,0==a.length)return.9;if(a.length>this.length)return 0;for(var c=a.length;c>0;c--){var d=a.substring(0,c),e=this.indexOf(d);if(!(0>e||e+a.length>this.length+b)){var f=this.substring(e+d.length),g=null;g=c>=a.length?"":a.substring(c);var h=f.score(g,b+e);if(h>0){var i=this.length-f.length;if(0!=e){var j=0,k=this.charCodeAt(e-1);if(32==k||9==k)for(var j=e-2;j>=0;j--)k=this.charCodeAt(j),i-=32==k||9==k?1:.15;else i-=e}return i+=h*f.length,i/=this.length}}}return 0},ccm_openThemeLauncher=function(){jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.showLoader(),ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/themes",width:"905",modal:!1,height:"410"})},"open_theme_launcher")},ccm_testMarketplaceConnection=function(a,b,c){mpIDStr=c?"&mpID="+c:"",b||(b=""),params={mpID:c},$.getJSON(CCM_TOOLS_PATH+"/marketplace/connect",params,function(c){return c.isConnected?(a(),void 0):($.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/frame?task="+b+mpIDStr,width:"90%",modal:!1,height:"70%"}),!1)})},ccm_openAddonLauncher=function(){jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.showLoader(),ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/add-ons",width:"905",modal:!1,height:"410"})},"open_addon_launcher")},ccm_setupMarketplaceDialogForm=function(){$(".ccm-pane-dialog-pagination").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]),$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove(),$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))}),$(".ccm-pane-dialog-pagination a").click(function(){return jQuery.fn.dialog.showLoader(),$("#ccm-marketplace-browser-form").closest(".ui-dialog-content").load($(this).attr("href"),function(){jQuery.fn.dialog.hideLoader()}),!1}),ccm_marketplaceBrowserInit(),$("#ccm-marketplace-browser-form").ajaxForm({beforeSubmit:function(){jQuery.fn.dialog.showLoader()},success:function(a){jQuery.fn.dialog.hideLoader(),$("#ccm-marketplace-browser-form").closest(".ui-dialog-content").html(a)}})},ccm_marketplaceBrowserInit=function(){$(".ccm-marketplace-item").click(function(){ccm_getMarketplaceItemDetails($(this).attr("mpID"))}),$(".ccm-marketplace-item-thumbnail").mouseover(function(){var a=$(this).parent().find("div.ccm-marketplace-results-image-hover").clone().addClass("ccm-marketplace-results-image-hover-displayed").appendTo(document.body),b=$(this).offset().top,c=$(this).offset().left;c+=60,a.css("top",b).css("left",c),a.show()}),$(".ccm-marketplace-item-thumbnail").mouseout(function(){$(".ccm-marketplace-results-image-hover-displayed").hide().remove()})},ccm_getMarketplaceItemDetails=function(a){jQuery.fn.dialog.showLoader(),$("#ccm-intelligent-search-results").hide(),ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/details?mpID="+a,width:820,appendButtons:!0,modal:!1,height:640})},"get_item_details",a)},ccm_getMarketplaceItem=function(a){var b=a.mpID,c=a.closeTop;this.onComplete=function(){},a.onComplete&&(ccm_getMarketplaceItem.onComplete=a.onComplete),c&&jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.showLoader(),params={mpID:b},$.getJSON(CCM_TOOLS_PATH+"/marketplace/connect",params,function(a){jQuery.fn.dialog.hideLoader(),a.isConnected?a.purchaseRequired?$.fn.dialog.open({title:ccmi18n.communityCheckout,iframe:!0,href:CCM_TOOLS_PATH+"/marketplace/checkout?mpID="+b,width:"560px",modal:!1,height:"400px"}):$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/download?install=1&mpID="+b,width:500,appendButtons:!0,modal:!1,height:400}):$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/frame?task=get&mpID="+b,width:"90%",modal:!1,height:"70%"})})},ccm_triggerProgressiveOperation=function(a,b,c,d,e){jQuery.fn.dialog.showLoader(),$("#ccm-dialog-progress-bar").remove(),$.ajax({url:a,type:"POST",data:b,success:function(f){jQuery.fn.dialog.hideLoader(),$('<div id="ccm-dialog-progress-bar" />').appendTo(document.body).html(f).jqdialog({autoOpen:!1,height:200,width:400,modal:!0,title:c,closeOnEscape:!1,open:function(){$(".ui-dialog-titlebar-close",this.parentNode).hide();var c=$("#ccm-progressive-operation-progress-bar").attr("data-total-items");ccm_doProgressiveOperation(a,b,c,d,e)}}),$("#ccm-dialog-progress-bar").jqdialog("open")}})},ccm_doProgressiveOperation=function(a,b,c,d,e){b.push({name:"process",value:"1"}),b.process=!0,$.ajax({url:a,dataType:"json",type:"POST",data:b,error:function(a,b){switch(b){case"timeout":var c=ccmi18n.requestTimeout;break;default:var c=a.responseText}$("#ccm-dialog-progress-bar").dialog("option","height",200),$("#ccm-dialog-progress-bar").dialog("option","closeOnEscape",!0),$("#ccm-progressive-operation-progress-bar").html('<div class="alert alert-error">'+c+"</div>"),$(".ui-dialog-titlebar-close").show()},success:function(f){if(f.error){var g=f.message;$("#ccm-dialog-progress-bar").dialog("option","height",200),$("#ccm-dialog-progress-bar").dialog("option","closeOnEscape",!0),$("#ccm-progressive-operation-progress-bar").html('<div class="alert alert-error">'+g+"</div>"),$(".ui-dialog-titlebar-close").show(),"function"==typeof e&&e(f)}else{var h=f.totalItems,i=Math.round((c-h)/c*100);$("#ccm-progressive-operation-status").html(1),c-h>0&&$("#ccm-progressive-operation-status").html(c-h),$("#ccm-progressive-operation-progress-bar div.bar").width(i+"%"),h>0?setTimeout(function(){ccm_doProgressiveOperation(a,b,c,d,e)},250):setTimeout(function(){$("#ccm-progressive-operation-progress-bar div.bar").width("0%"),$("#ccm-dialog-progress-bar").dialog("close"),"function"==typeof d&&d(f)},1e3)}}})};var CCMInlineEditMode=function(){return enterInlineEditMode=function(a){$.fn.ccmmenu.disable(),CCMToolbar.disable(),$("div.ccm-area").addClass("ccm-area-inline-edit-disabled"),a&&a.addClass("ccm-block-edit-inline-active")},completeInlineEditMode=function(a){$("#ccm-inline-toolbar-container").remove();var b=a.find(".ccm-inline-toolbar"),c=$("<div />",{id:"ccm-inline-toolbar-container"}).appendTo(document.body),d=$(window),e=a.offset(),f=e.left;b.appendTo(c);var g=f+parseInt(b.width());if(g>d.width()){var h=g-(f+a.width());b.css("left",f-h)}else b.css("left",f);b.css("opacity",1),b.find(".dialog-launch").dialog();var i=e.top-c.outerHeight()-5;c.css("top",i).css("opacity",1),d.scrollTop()>i&&($("#ccm-toolbar-disabled,#ccm-toolbar").css("opacity",0),c.addClass("ccm-inline-toolbar-affixed")),d.on("scroll.inline-toolbar",function(){c.toggleClass("ccm-inline-toolbar-affixed",d.scrollTop()>i),d.scrollTop()>i?$("#ccm-toolbar-disabled,#ccm-toolbar").css("opacity",0):$("#ccm-toolbar-disabled,#ccm-toolbar").css("opacity",1)})},{exit:function(a){$(document).trigger("inlineEditCancel",[a])},finishExit:function(){$("div.ccm-area-edit-inline-active").removeClass("ccm-area-edit-inline-active"),$.fn.ccmmenu.enable(),$("div.ccm-block-edit-inline-active").remove(),$(window).unbind("scroll.inline-toolbar"),$("div.ccm-area").removeClass("ccm-area-inline-edit-disabled"),CCMToolbar.enable(),$("#ccm-toolbar").css("opacity",1),$("#ccm-inline-toolbar-container").remove(),jQuery.fn.dialog.hideLoader(),CCMEditMode.start()},editBlock:function(a,b,c,d,e){var f=[{name:"btask",value:"edit"},{name:"cID",value:a},{name:"arHandle",value:c},{name:"aID",value:b},{name:"bID",value:d}];if(e)for(var g in e)f.push({name:g,value:e[g]});jQuery.fn.dialog.showLoader(),enterInlineEditMode($("[data-block-id="+d+"][data-area-id="+b+"]")),$.ajax({type:"GET",url:CCM_TOOLS_PATH+"/edit_block_popup",data:f,success:function(a){var c=$("[data-block-id="+d+"][data-area-id="+b+"]");c.html(a),completeInlineEditMode(c),jQuery.fn.dialog.hideLoader()}})},loadAdd:function(a,b,c,d,e){var f=[{name:"btask",value:"edit"},{name:"cID",value:a},{name:"arHandle",value:b},{name:"btID",value:d}];if(e)for(var g in e)f.push({name:g,value:e[g]});jQuery.fn.dialog.showLoader(),enterInlineEditMode(),$.ajax({type:"GET",url:CCM_TOOLS_PATH+"/add_block_popup",data:f,success:function(a){if(jQuery.fn.dialog.closeAll(),$("#ccm-add-new-block-placeholder").length>0)var b=$("#ccm-add-new-block-placeholder");else var b=$("#a"+c);b.addClass("ccm-area-edit-inline-active"),b.append($('<div id="a'+c+"-bt"+d+'" class="ccm-block-edit-inline-active">'+a+"</div>"));var e=$("#a"+c+"-bt"+d);completeInlineEditMode(e),jQuery.fn.dialog.hideLoader()}})}}}(),ccm_searchActivatePostFunction=new Array;ccm_setupAdvancedSearchFields=function(a){ccm_totalAdvancedSearchFields=$(".ccm-search-request-field-set").length,$("#ccm-"+a+"-search-add-option").unbind(),$("#ccm-"+a+"-search-add-option").click(function(){ccm_totalAdvancedSearchFields++,$("#ccm-search-fields-wrapper").length>0?$("#ccm-search-fields-wrapper").append('<div class="ccm-search-field" id="ccm-'+a+"-search-field-set"+ccm_totalAdvancedSearchFields+'">'+$("#ccm-search-field-base").html()+"</div>"):$("#ccm-"+a+"-search-advanced-fields").append('<tr class="ccm-search-field" id="ccm-'+a+"-search-field-set"+ccm_totalAdvancedSearchFields+'">'+$("#ccm-search-field-base").html()+"</tr>"),ccm_activateAdvancedSearchFields(a,ccm_totalAdvancedSearchFields)});var b=1;$(".ccm-search-request-field-set").each(function(){ccm_activateAdvancedSearchFields(a,b),b++})},ccm_setupAdvancedSearch=function(a){ccm_setupAdvancedSearchFields(a),$("#ccm-"+a+"-advanced-search").ajaxForm({beforeSubmit:function(){ccm_deactivateSearchResults(a)},success:function(b){ccm_parseAdvancedSearchResponse(b,a)}}),ccm_setupInPagePaginationAndSorting(a),ccm_setupSortableColumnSelection(a)},ccm_parseAdvancedSearchResponse=function(a,b){var c=$("#ccm-"+b+"-search-results");(0==c.length||null==b)&&(c=$("#ccm-search-results")),c.html(a),ccm_activateSearchResults(b)},ccm_deactivateSearchResults=function(a){var b=$("#ccm-"+a+"-search-fields-submit");(0==b.length||null==a)&&(b=$("#ccm-search-fields-submit")),b.attr("disabled",!0);var b=$("#ccm-"+a+"-search-results table.ccm-results-list");(0==b.length||null==a)&&(b=$("#ccm-search-results")),b.css("opacity",.4),jQuery.fn.dialog.showLoader()},ccm_activateSearchResults=function(a){0==$(".ui-dialog-content").length?window.scrollTo(0,0):$(".ui-dialog-content").each(function(){$(this).get(0).scrollTop=0}),$(".dialog-launch").dialog();var b=$("#ccm-"+a+"-search-results table.ccm-results-list");(0==b.length||null==a)&&(b=$("#ccm-search-results")),b.css("opacity",1),jQuery.fn.dialog.hideLoader();var b=$("#ccm-"+a+"-search-fields-submit");(0==b.length||null==a)&&(b=$("#ccm-search-fields-submit")),b.attr("disabled",!1),ccm_setupInPagePaginationAndSorting(a),ccm_setupSortableColumnSelection(a),"function"==typeof ccm_searchActivatePostFunction[a]&&ccm_searchActivatePostFunction[a]()},ccm_setupInPagePaginationAndSorting=function(a){$(".ccm-results-list th a").click(function(){ccm_deactivateSearchResults(a);var b=$("#ccm-"+a+"-search-results");return 0==b.length&&(b=$("#ccm-search-results")),b.load($(this).attr("href"),!1,function(){ccm_activateSearchResults(a)}),!1}),$("div.ccm-pagination a").click(function(){if(!$(this).parent().hasClass("disabled")){ccm_deactivateSearchResults(a);var b=$("#ccm-"+a+"-search-results");0==b.length&&(b=$("#ccm-search-results")),b.load($(this).attr("href"),!1,function(){ccm_activateSearchResults(a),$("div.ccm-dialog-content").attr("scrollTop",0)})}return!1}),$(".ccm-pane-dialog-pagination").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]),$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove(),$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))})},ccm_setupSortableColumnSelection=function(){$("#ccm-list-view-customize").unbind(),$("#ccm-list-view-customize").click(function(){return jQuery.fn.dialog.open({width:550,height:350,appendButtons:!0,modal:!1,href:$(this).attr("href"),title:ccmi18n.customizeSearch}),!1})},ccm_checkSelectedAdvancedSearchField=function(a,b){$("#ccm-"+a+"-search-field-set"+b+" .ccm-search-option-type-date_time input").each(function(){$(this).attr("id",$(this).attr("id")+b)}),$("#ccm-"+a+"-search-field-set"+b+" .ccm-search-option-type-date_time input").datepicker({showAnim:"fadeIn"}),$("#ccm-"+a+"-search-field-set"+b+" .ccm-search-option-type-rating input").rating()},ccm_activateAdvancedSearchFields=function(a,b){var c=$("#ccm-"+a+"-search-field-set"+b+" select:first");c.unbind(),c.change(function(){var c=$(this).find(":selected").val();$(this).parent().parent().find("input.ccm-"+a+"-selected-field").val(c);var d=$("#ccm-"+a+"-search-field-base-elements span[search-field="+c+"]");$("#ccm-"+a+"-search-field-set"+b+" .ccm-selected-field-content").html(""),d.clone().appendTo("#ccm-"+a+"-search-field-set"+b+" .ccm-selected-field-content"),$("#ccm-"+a+"-search-field-set"+b+" .ccm-selected-field-content .ccm-search-option").show(),ccm_checkSelectedAdvancedSearchField(a,b)}),$("#ccm-"+a+"-search-field-set"+b+" .ccm-search-remove-option").unbind(),$("#ccm-"+a+"-search-field-set"+b+" .ccm-search-remove-option").click(function(){$(this).parents("div.ccm-search-field").remove(),$(this).parents("tr.ccm-search-field").remove()}),ccm_checkSelectedAdvancedSearchField(a,b)},ccm_activateEditablePropertiesGrid=function(){$("tr.ccm-attribute-editable-field").each(function(){var a=$(this);$(this).find("a").click(function(){a.find(".ccm-attribute-editable-field-text").hide(),a.find(".ccm-attribute-editable-field-clear-button").hide(),a.find(".ccm-attribute-editable-field-form").show(),a.find(".ccm-attribute-editable-field-save-button").show()}),a.find("form").submit(function(){return!1}),a.find(".ccm-attribute-editable-field-save-button").parent().click(function(){var b=a.find("form input[name=task]");"clear_extended_attribute"==b.val()&&(b.val(b.attr("data-original-task")),b.attr("data-original-task","")),ccm_submitEditablePropertiesGrid(a)}),a.find(".ccm-attribute-editable-field-clear-button").parent().unbind(),a.find(".ccm-attribute-editable-field-clear-button").parent().click(function(){var b=a.find("form input[name=task]");return b.attr("data-original-task",b.val()),b.val("clear_extended_attribute"),ccm_submitEditablePropertiesGrid(a),!1})})},ccm_submitEditablePropertiesGrid=function(a){a.find(".ccm-attribute-editable-field-save-button").hide(),a.find(".ccm-attribute-editable-field-clear-button").hide(),a.find(".ccm-attribute-editable-field-loading").show();try{tinyMCE.triggerSave(!0,!0)}catch(b){}a.find("form").ajaxSubmit(function(b){a.find(".ccm-attribute-editable-field-loading").hide(),a.find(".ccm-attribute-editable-field-save-button").show(),a.find(".ccm-attribute-editable-field-text").html(b),a.find(".ccm-attribute-editable-field-form").hide(),a.find(".ccm-attribute-editable-field-save-button").hide(),a.find(".ccm-attribute-editable-field-text").show(),a.find(".ccm-attribute-editable-field-clear-button").show(),a.find("td").show("highlight",{color:"#FFF9BB"})})},ccm_triggerSelectUser=function(a,b,c){alert(a),alert(b),alert(c)
},ccm_triggerSelectGroup=function(a,b){alert(a),alert(b)},ccm_setupUserSearch=function(a){$(".chosen-select").chosen(),$("#ccm-user-list-cb-all").click(function(){1==$(this).prop("checked")?($(".ccm-list-record td.ccm-user-list-cb input[type=checkbox]").attr("checked",!0),$("#ccm-user-list-multiple-operations").attr("disabled",!1)):($(".ccm-list-record td.ccm-user-list-cb input[type=checkbox]").attr("checked",!1),$("#ccm-user-list-multiple-operations").attr("disabled",!0))}),$("td.ccm-user-list-cb input[type=checkbox]").click(function(){$("td.ccm-user-list-cb input[type=checkbox]:checked").length>0?$("#ccm-user-list-multiple-operations").attr("disabled",!1):$("#ccm-user-list-multiple-operations").attr("disabled",!0)}),$("#ccm-user-list-multiple-operations").change(function(){var b=$(this).val();switch(b){case"choose":;$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){ccm_triggerSelectUser($(this).val(),$(this).attr("user-name"),$(this).attr("user-email"))}),jQuery.fn.dialog.closeTop();break;case"properties":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_properties?"+uIDstring,title:ccmi18n.properties});break;case"activate":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_activate?searchInstance="+a+"&"+uIDstring,title:ccmi18n.user_activate});break;case"deactivate":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_deactivate?searchInstance="+a+"&"+uIDstring,title:ccmi18n.user_deactivate});break;case"group_add":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_group_add?searchInstance="+a+"&"+uIDstring,title:ccmi18n.user_group_add});break;case"group_remove":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_group_remove?searchInstance="+a+"&"+uIDstring,title:ccmi18n.user_group_remove});break;case"delete":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_delete?searchInstance="+a+"&"+uIDstring,title:ccmi18n.user_delete})}$(this).get(0).selectedIndex=0})},ccm_setupGroupSearchPaging=function(){$("div#ccm-group-paging").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]),$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove(),$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))})},ccm_setupGroupSearch=function(a){$("div.ccm-group a").unbind(),func=a?window[a]:ccm_triggerSelectGroup,$("div.ccm-group a").each(function(){var a=$(this);$(this).click(function(){return func(a.attr("group-id"),a.attr("group-name")),$.fn.dialog.closeTop(),!1})}),$("#ccm-group-search").ajaxForm({beforeSubmit:function(){$("#ccm-group-search-wrapper").html("")},success:function(a){$("#ccm-group-search-wrapper").html(a)}}),ccm_setupGroupSearchPaging(),$("div#ccm-group-paging a").click(function(){return $("#ccm-group-search-wrapper").html(""),$.ajax({type:"GET",url:$(this).attr("href"),success:function(a){$("#ccm-group-search-wrapper").html(a)}}),!1})},"function"!=typeof ccm_selectSitemapNode&&(ccm_selectSitemapNode=function(a,b){alert(a),alert(b)}),ccm_sitemapSetupSearch=function(a){$.fn.ccmmenu.enable(),ccm_setupAdvancedSearch(a),ccm_sitemapSetupSearchPages(a),ccm_searchActivatePostFunction[a]=function(){ccm_sitemapSetupSearchPages(a),ccm_sitemapSearchSetupCheckboxes(a)},ccm_sitemapSearchSetupCheckboxes(a)},ccm_sitemapSearchSetupCheckboxes=function(a){$("#ccm-"+a+"-list-cb-all").click(function(b){b.stopPropagation(),1==$(this).prop("checked")?($(".ccm-list-record td.ccm-"+a+"-list-cb input[type=checkbox]").attr("checked",!0),$("#ccm-"+a+"-list-multiple-operations").attr("disabled",!1)):($(".ccm-list-record td.ccm-"+a+"-list-cb input[type=checkbox]").attr("checked",!1),$("#ccm-"+a+"-list-multiple-operations").attr("disabled",!0))}),$("td.ccm-"+a+"-list-cb input[type=checkbox]").click(function(b){b.stopPropagation(),$("td.ccm-"+a+"-list-cb input[type=checkbox]:checked").length>0?$("#ccm-"+a+"-list-multiple-operations").attr("disabled",!1):$("#ccm-"+a+"-list-multiple-operations").attr("disabled",!0)}),$("#ccm-"+a+"-list-multiple-operations").change(function(){var b=$(this).val();switch(cIDstring="",$("td.ccm-"+a+"-list-cb input[type=checkbox]:checked").each(function(){cIDstring=cIDstring+"&cID[]="+$(this).val()}),b){case"delete":jQuery.fn.dialog.open({width:500,height:400,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/delete?"+cIDstring+"&searchInstance="+a,title:ccmi18n_sitemap.deletePages});break;case"design":jQuery.fn.dialog.open({width:610,height:405,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/design?"+cIDstring+"&searchInstance="+a,title:ccmi18n_sitemap.pageDesign});break;case"move_copy":jQuery.fn.dialog.open({width:640,height:340,modal:!1,href:CCM_TOOLS_PATH+"/sitemap_overlay?instance_id="+a+"&select_mode=move_copy_delete&"+cIDstring,title:ccmi18n_sitemap.moveCopyPage});break;case"speed_settings":jQuery.fn.dialog.open({width:610,height:340,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/speed_settings?"+cIDstring,title:ccmi18n_sitemap.speedSettingsTitle});break;case"permissions":jQuery.fn.dialog.open({width:430,height:630,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/permissions?"+cIDstring,title:ccmi18n_sitemap.pagePermissionsTitle});break;case"permissions_add_access":jQuery.fn.dialog.open({width:440,height:200,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/permissions_access?task=add&"+cIDstring,title:ccmi18n_sitemap.pagePermissionsTitle});break;case"permissions_remove_access":jQuery.fn.dialog.open({width:440,height:300,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/permissions_access?task=remove&"+cIDstring,title:ccmi18n_sitemap.pagePermissionsTitle});break;case"properties":jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/pages/bulk_metadata_update?"+cIDstring,title:ccmi18n_sitemap.pagePropertiesTitle})}$(this).get(0).selectedIndex=0})},ccm_sitemapSetupSearchPages=function(a){$("#ccm-"+a+"-list tr").click(function(a){var b=$(this);if(b.hasClass("ccm-results-list-header"))return!1;var c=$.fn.ccmsitemap("getMenu",jQuery.parseJSON($(this).attr("data-page-menu")));c&&$.fn.ccmmenu.showmenu(a,c)})};var ccmCustomStyle={tabs:function(a,b){return $(".ccm-styleEditPane").hide(),$("#ccm-styleEditPane-"+b).show(),$(a.parentNode.parentNode).find("li").removeClass("ccm-nav-active"),$(a.parentNode).addClass("ccm-nav-active"),!1},resetAll:function(){return confirm(ccmi18n.confirmCssReset)?(jQuery.fn.dialog.showLoader(),$("#ccm-reset-style").val(1),$("#ccmCustomCssForm").get(0).submit(),!0):!1},showPresetDeleteIcon:function(){$("select[name=cspID]").val()>0?$("#ccm-style-delete-preset").show():$("#ccm-style-delete-preset").hide()},deletePreset:function(){var a=$("select[name=cspID]").val();if(a>0){if(!confirm(ccmi18n.confirmCssPresetDelete))return!1;var b=$("#ccm-custom-style-refresh-action").val()+"&deleteCspID="+a+"&subtask=delete_custom_style_preset";jQuery.fn.dialog.showLoader(),$.get(b,function(a){$("#ccm-custom-style-wrapper").html(a),jQuery.fn.dialog.hideLoader()})}},initForm:function(){$("#cspFooterPreset").length>0&&$("#ccmCustomCssFormTabs input, #ccmCustomCssFormTabs select, #ccmCustomCssFormTabs textarea").bind("change click",function(){$("#cspFooterPreset").show(),$("#cspFooterNoPreset").remove(),$("#ccmCustomCssFormTabs input, #ccmCustomCssFormTabs select").unbind("change click")}),$("input[name=cspPresetAction]").click(function(){"create_new_preset"==$(this).val()&&$(this).prop("checked")?$("input[name=cspName]").attr("disabled",!1).focus():$("input[name=cspName]").val("").attr("disabled",!0)}),ccmCustomStyle.showPresetDeleteIcon(),ccmCustomStyle.lastPresetID=parseInt($("select[name=cspID]").val()),$("select[name=cspID]").change(function(){var a=parseInt($(this).val()),b=parseInt($("input[name=selectedCsrID]").val());if(ccmCustomStyle.lastPresetID==a)return!1;if(ccmCustomStyle.lastPresetID=a,jQuery.fn.dialog.showLoader(),a>0)var c=$("#ccm-custom-style-refresh-action").val()+"&cspID="+a;else var c=$("#ccm-custom-style-refresh-action").val()+"&csrID="+b;$.get(c,function(a){$("#ccm-custom-style-wrapper").html(a),jQuery.fn.dialog.hideLoader()})}),$("#ccmCustomCssForm").submit(function(){return 1==$("input[name=cspCreateNew]").prop("checked")&&""==$("input[name=cspName]").val()?($("input[name=cspName]").focus(),alert(ccmi18n.errorCustomStylePresetNoName),!1):(jQuery.fn.dialog.showLoader(),!0)}),parseInt(ccmCustomStyle.lastPresetID)||setTimeout('$("#ccmCustomCssFormTabs input").attr("disabled", false).get(0).focus()',500)},validIdCheck:function(a,b){var c=$("#"+a.value);c&&c.get(0)&&c.get(0).id!=b?$("#ccm-styles-invalid-id").css("display","block"):$("#ccm-styles-invalid-id").css("display","none")}};ccm_activateTabBar=function(a){$("#ccm-tab-content-"+a.find("li[class=active] a").attr("data-tab")).show(),a.find("a").unbind().click(function(){a.find("li").removeClass("active"),$(this).parent().addClass("active"),a.find("a").each(function(){$("#ccm-tab-content-"+$(this).attr("data-tab")).hide()});var b=$(this).attr("data-tab");return $("#ccm-tab-content-"+b).show(),!1})};var CCMToolbar=function(){var a,b,c=$("#ccm-toolbar"),d=$("#ccm-nav-intelligent-search"),e=$("#ccm-intelligent-search-results");return setupHelpNotifications=function(){$(document.body).on("click","a[data-dismiss]",function(){var a="help-all"==$(this).attr("data-dismiss")?"all":"this";$(this).parentsUntil(".ccm-notification-help").parent().queue(function(){$(this).css("opacity",0),$(this).dequeue()}).delay(500).queue(function(){$(this).remove(),$(this).dequeue()}),$.ajax({type:"post",data:{type:$(this).attr("data-help-notification-type"),identifier:$(this).attr("data-help-notification-identifier"),action:a,ccm_token:CCM_SECURITY_TOKEN},url:CCM_TOOLS_PATH+"/help/dismiss",success:function(){}})})},setupTooltips=function(){0==$("#ccm-tooltip-holder").length&&$("<div />").attr("id","ccm-tooltip-holder").attr("class","ccm-ui").prependTo(document.body),$(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"})},setupPanels=function(){$("<div />",{id:"ccm-panel-overlay"}).appendTo($(document.body)),$("[data-launch-panel]").unbind().on("click",function(){var a=$(this).attr("data-launch-panel");$(this).toggleClass("ccm-launch-panel-active");var b=CCMPanelManager.getByIdentifier(a);return b.toggle(),!1}),$("html").addClass("ccm-panel-ready")},setupStatusBar=function(){$("#ccm-page-status-bar .alert").bind("closed",function(){$(this).remove();var a=$("#ccm-page-status-bar .alert:visible").length;0==a&&$("#ccm-page-status-bar").remove()}),$("#ccm-page-status-bar .ccm-status-bar-ajax-form").ajaxForm({dataType:"json",beforeSubmit:function(){jQuery.fn.dialog.showLoader()},success:function(a){a.redirect&&(window.location.href=a.redirect)}})},setupIntelligentSearch=function(){d.bind("keydown.ccm-intelligent-search",function(a){if(13==a.keyCode||40==a.keyCode||38==a.keyCode){if(a.preventDefault(),a.stopPropagation(),13==a.keyCode&&$("a.ccm-intelligent-search-result-selected").length>0){var b=$("a.ccm-intelligent-search-result-selected").attr("href");b&&"#"!=b&&"javascript:void(0)"!=b?window.location.href=b:$("a.ccm-intelligent-search-result-selected").click()}var c,d=$("#ccm-intelligent-search-results li:visible");(40==a.keyCode||38==a.keyCode)&&($.each(d,function(b,e){$(e).children("a").hasClass("ccm-intelligent-search-result-selected")&&(io=38==a.keyCode?d[b-1]:d[b+1],c=$(io).find("a"))}),c&&c.length>0&&($("a.ccm-intelligent-search-result-selected").removeClass(),$(c).addClass("ccm-intelligent-search-result-selected")))}}),d.liveUpdate("ccm-intelligent-search-results","intelligent-search"),d.bind("keyup.ccm-intelligent-search",function(){doRemoteSearchCall($(this).val())}),d.bind("click",function(){""==this.value&&e.hide()})},activateIntelligentSearchResults=function(){0==$("#ccm-intelligent-search-results div:visible").length&&$("#ccm-intelligent-search-results").hide(),$("#ccm-intelligent-search-results a").hover(function(){$("a.ccm-intelligent-search-result-selected").removeClass(),$(this).addClass("ccm-intelligent-search-result-selected")},function(){$(this).removeClass("ccm-intelligent-search-result-selected")})},doRemoteSearchCall=function(c){if(c=jQuery.trim(c),c&&c.length>2){if(c==a)return;b&&window.clearTimeout(b),a=c,b=window.setTimeout(function(){b=null,$("#ccm-intelligent-search-results-list-marketplace").parent().show(),$("#ccm-intelligent-search-results-list-help").parent().show(),$("#ccm-intelligent-search-results-list-your-site").parent().show(),$("#ccm-intelligent-search-results-list-marketplace").parent().addClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-help").parent().addClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-your-site").parent().addClass("ccm-intelligent-search-results-module-loading"),$.getJSON(CCM_TOOLS_PATH+"/marketplace/intelligent_search",{q:a},function(a){for($("#ccm-intelligent-search-results-list-marketplace").parent().removeClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-marketplace").html(""),i=0;i<a.length;i++){var b=a[i],c="ccm_getMarketplaceItemDetails("+b.mpID+")";$("#ccm-intelligent-search-results-list-marketplace").append('<li><a href="javascript:void(0)" onclick="'+c+'"><img src="'+b.img+'" />'+b.name+"</a></li>")}0==a.length&&$("#ccm-intelligent-search-results-list-marketplace").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),activateIntelligentSearchResults()}).error(function(){$("#ccm-intelligent-search-results-list-marketplace").parent().hide()}),$.getJSON(CCM_TOOLS_PATH+"/get_remote_help",{q:a},function(a){for($("#ccm-intelligent-search-results-list-help").parent().removeClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-help").html(""),i=0;i<a.length;i++){var b=a[i];$("#ccm-intelligent-search-results-list-help").append('<li><a href="'+b.href+'">'+b.name+"</a></li>")}0==a.length&&$("#ccm-intelligent-search-results-list-help").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),activateIntelligentSearchResults()}).error(function(){$("#ccm-intelligent-search-results-list-help").parent().hide()}),$.getJSON(CCM_TOOLS_PATH+"/pages/intelligent_search",{q:a},function(a){for($("#ccm-intelligent-search-results-list-your-site").parent().removeClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-your-site").html(""),i=0;i<a.length;i++){var b=a[i];$("#ccm-intelligent-search-results-list-your-site").append('<li><a href="'+b.href+'">'+b.name+"</a></li>")}0==a.length&&$("#ccm-intelligent-search-results-list-your-site").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),activateIntelligentSearchResults()}).error(function(){$("#ccm-intelligent-search-results-list-your-site").parent().hide()})},500)}},{start:function(){c.length>0&&(c.find(".dialog-launch").dialog(),setupStatusBar(),setupIntelligentSearch(),setupPanels(),setupTooltips(),setupHelpNotifications(),$("#ccm-toolbar-menu-dashboard").on("click",function(a){a.stopPropagation()}))},disable:function(){$("#ccm-toolbar-disabled").remove(),$("<div />",{id:"ccm-toolbar-disabled"}).appendTo(document.body),setTimeout(function(){$("#ccm-toolbar-disabled").css("opacity",1)},10)},enable:function(){$("#ccm-toolbar-disabled").remove()},disableDirectExit:function(){var a=$("li.ccm-toolbar-page-edit a");"check-in"!=a.attr("data-launch-panel")&&a.attr("data-launch-panel","check-in").on("click",function(){$(this).toggleClass("ccm-launch-panel-active");var a=CCMPanelManager.getByIdentifier("check-in");return a.toggle(),!1})}}}();ccm_marketplaceDetailShowMore=function(){$(".ccm-marketplace-item-information-more").hide(),$(".ccm-marketplace-item-information-inner").css("max-height","none")},ccm_marketplaceUpdatesShowMore=function(a){$(a).parent().hide(),$(a).parent().parent().find(".ccm-marketplace-update-changelog").css("max-height","none")},ccm_enableDesignScrollers=function(){$("a.ccm-scroller-l").hover(function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_l_active.png")},function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_l.png")}),$("a.ccm-scroller-r").hover(function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_r_active.png")},function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_r.png")});var a=4,b=132;$("a.ccm-scroller-r").unbind("click"),$("a.ccm-scroller-l").unbind("click"),$("a.ccm-scroller-r").click(function(){var c=$(this).parent().children("div.ccm-scroller-inner").children("ul"),d=$(this).parent().attr("current-page"),e=$(this).parent().attr("current-pos"),f=$(this).parent().attr("num-pages"),g=a*b;e=parseInt(e)-g,d++,$(this).parent().attr("current-page",d),$(this).parent().attr("current-pos",e),d==f&&$(this).hide(),d>1&&$(this).siblings("a.ccm-scroller-l").show(),$(c).css("left",e+"px")}),$("a.ccm-scroller-l").click(function(){var c=$(this).parent().children("div.ccm-scroller-inner").children("ul"),d=$(this).parent().attr("current-page"),e=$(this).parent().attr("current-pos"),f=$(this).parent().attr("num-pages"),g=a*b;e=parseInt(e)+g,d--,$(this).parent().attr("current-page",d),$(this).parent().attr("current-pos",e),1==d&&$(this).hide(),f>d&&$(this).siblings("a.ccm-scroller-r").show(),$(c).css("left",e+"px")}),$("a.ccm-scroller-l").hide(),$("a.ccm-scroller-r").each(function(){1==parseInt($(this).parent().attr("num-pages"))&&$(this).hide()}),$("#ccm-select-page-type a").click(function(){$("#ccm-select-page-type li").each(function(){$(this).removeClass("ccm-item-selected")}),$(this).parent().addClass("ccm-item-selected"),$("input[name=ptID]").val($(this).attr("ccm-page-type-id"))}),$("#ccm-select-theme a").click(function(){$("#ccm-select-theme li").each(function(){$(this).removeClass("ccm-item-selected")}),$(this).parent().addClass("ccm-item-selected"),$("input[name=plID]").val($(this).attr("ccm-theme-id"))})};